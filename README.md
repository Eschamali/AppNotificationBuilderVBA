# âœ… ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’ã€VBAã§ï¼

ã€ŒExcelã‹ã‚‰é€šçŸ¥ã‚’å‡ºã›ãŸã‚‰ä¾¿åˆ©ãªã®ã«â€¦ã€  
ãã‚“ãªé¡˜ã„ã€**VBA Ã— C++ DLLã®é€£æº**ã§å®Ÿç¾ã—ã¾ã—ãŸã€‚

Windows 10/11ã§æ¨™æº–æ­è¼‰ã•ã‚Œã¦ã„ã‚‹**ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥**ã‚’ã€  
VBAã‹ã‚‰ç°¡å˜ã«ä½¿ãˆã‚‹ã‚ˆã†ã«ã—ãŸæ‹¡å¼µãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã™ã€‚

ğŸ“¢ ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã«ï¼  
ğŸ“Š ãƒ¬ãƒãƒ¼ãƒˆå®Œäº†ã®é€šçŸ¥ã«ï¼  
ğŸ¯ å…¥åŠ›ãƒŸã‚¹ã‚„å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ï¼  
âš™ï¸ ãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§æŒ‡å®šãƒã‚¯ãƒ­ã‚’å®Ÿè¡Œï¼

**VBAã®é™ç•Œã‚’è¶…ãˆã¦ã€ãƒ¢ãƒ€ãƒ³ãªUIé€šçŸ¥ã‚’ã‚ãªãŸã®Excelã«ã€‚**

# DEMO

| ã‚·ãƒãƒ¥ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ä¾‹            | å‹•ä½œã‚¤ãƒ¡ãƒ¼ã‚¸ | 
| ---------------------------- |   ------------ | 
| å‡¦ç†çµ‚äº† ãã®1                    | ![alt text](doc/Demo1.png)       | 
| å‡¦ç†çµ‚äº† ãã®2          | ![alt text](doc/Demo2.png)       | 
| ãƒªãƒã‚¤ãƒ³ãƒ‰é€šçŸ¥          | ![alt text](doc/Demo3.png)       | 
| ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ä»˜ãé€šçŸ¥          | ![alt text](doc/Demo4.gif)       | 

ä»–ã«ã‚‚æ§˜ã€…ãªã‚¢ãƒ—ãƒªé€šçŸ¥ã®å¤–è¦³ã‚’è¨­å®šã§ãã¾ã™ã€‚è¨­å®šæ–¹æ³•ç­‰ã¯å¾Œè¿°ã—ã¾ã™ã€‚

# Features

- DLLã‚¤ãƒ³ãƒãƒ¼ãƒˆã¨å°‚ç”¨ã«ç”¨æ„ã•ã‚ŒãŸã‚¯ãƒ©ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€æ•°è¡Œã§æ‰‹è»½ã«ã‚¢ãƒ—ãƒªé€šçŸ¥ã®è¡¨ç¤ºãŒå¯èƒ½ã§ã™ã€‚
- DLLã‚¤ãƒ³ãƒãƒ¼ãƒˆãŒä½¿ç”¨ã§ããªã„ç’°å¢ƒã§ã‚‚ã€WindowsPowerShellã‚’çµŒç”±ã—ãŸã‚¢ãƒ—ãƒªé€šçŸ¥ã®è¡¨ç¤ºãŒå¯èƒ½ã§ã™ã€‚
- [ã€Œè‡ªå‹•çš„ã«é–‰ã˜ã‚‹MsgBoxã€](http://officetanaka.net/excel/vba/tips/tips21.htm)ã®ä»£ã‚ã‚Šã«ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚
- æ˜”ãªãŒã‚‰ã®é€šçŸ¥æ‰‹æ³•ï¼š[Shell_NotifyIconA](https://learn.microsoft.com/ja-jp/windows/win32/api/shellapi/nf-shellapi-shell_notifyicona)ã§ã¯ãªãã€WinRT APIã‚’ä½¿ã£ãŸé€šçŸ¥æ‰‹æ³•ãªã®ã§ã€ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ€§ãŒé«˜ã„ã§ã™ã€‚

# Development History

ã€Œè‡ªå‹•çš„ã«é–‰ã˜ã‚‹MsgBoxã€ã¨ã„ã†æ©Ÿèƒ½ã«ä¸€å®šã®ãƒ‹ãƒ¼ã‚ºã‚’æ„Ÿã˜ã€ãã®ä»£æ›¿ã¨ã—ã¦ä½œã£ã¦ã¿ã¾ã—ãŸã€‚<br>
ã“ã®æ©Ÿèƒ½ã¯ã€vbsã§å®Ÿç¾ã—ã¦ãŠã‚Šãã®vbsãŒã‚‚ã†ã™ãã§æœ€æ–°OSã§ã¯ã€æ­è¼‰ã—ãªããªã‚‹ã¨ã®ã“ã¨ã§è‰²ã€…ã¨è©¦è¡ŒéŒ¯èª¤ã—ã¦ä½œæˆã—ã¦ã¿ã¾ã—ãŸã€‚<br>
ãƒ¢ãƒ€ãƒ³ãªWindows ã¨ã®è¦ªå’Œæ€§ã‚’é«˜ã‚ã‚‹ãŸã‚ã«ã‚‚ã€ä½¿ã£ã¦ã¿ã¦ã¯ã„ã‹ãŒã§ã—ã‚‡ã†ã‹ï¼Ÿ

# Requirement

ä»¥ä¸‹ã§æ¤œè¨¼æ¸ˆã¿ã§ã™ã€‚

- Microsoft Office Excel 2019 ä»¥ä¸Š 64bit
- Windows 10 , 11 64bit

# Load DLL

WindowsAPIã®ã€ŒLoadLibraryé–¢æ•°ã€ã‚’ä½¿ã£ã¦ã€èª­ã¿è¾¼ã¿ã¾ã™ã€‚

```bas
hDll = LoadLibrary("AppNotificationBuilderVBA.dll")
```

å®Ÿéš›ã«ä½¿ã†å ´åˆã¯ã€"Excelãƒ•ã‚¡ã‚¤ãƒ«(.xlsm)ã®å­˜åœ¨ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª"ã¨ã„ã†ã‚ˆã†ãª[å‹•çš„ãªå ´æ‰€ã‚’è¨­å®šã™ã‚‹ä»•çµ„ã¿](https://liclog.net/vba-dll-create-5/)ã§èª­ã¿è¾¼ã‚€ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚

```bas
'å‹•çš„ã«DLLã‚’å–å¾—ã™ã‚‹ãŸã‚ã®WinAPI
Private Declare PtrSafe Function LoadLibrary Lib "kernel32" Alias "LoadLibraryA" (ByVal lpLibFileName As String) As LongPtr

Private Sub Workbook_Open()

    Dim hDll As LongPtr
    Dim sFolderPath As String
    
    'DLLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã™ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ãƒ‘ã‚¹ã‚’è¨­å®š
    sFolderPath = ThisWorkbook.Path
    
    'DLLï¾Œï½§ï½²ï¾™ã‚’èª­ã¿è¾¼ã‚€
    hDll = LoadLibrary(sFolderPath & "\" & "AppNotificationBuilderVBA.dll")ã€€'DLLãƒ•ã‚¡ã‚¤ãƒ«ãƒ•ãƒ«ãƒ‘ã‚¹

    debug.print hDll
End Sub
```

hDll ã®ä¸­èº«ãŒã€0 ä»¥å¤–ã§ã‚ã‚Œã°èª­ã¿è¾¼ã¿ã€æˆåŠŸã§ã™ã€‚

# Usage

1. [ã“ã®ã‚¯ãƒ©ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«](doc/AssistMakeToastSchema/clsAppNotificationBuilder.cls)ã‚’Visual Basic Editorã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ä¸‹ã•ã„ã€‚<br>

2. Visual Basic Editorã‚’é–‹ããƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã®ã€Œãƒ„ãƒ¼ãƒ«ã€â†’ã€Œå‚ç…§è¨­å®šã€â†’ã€ŒMicrosoft XML v6.0ã€ã«Checkã‚’ã„ã‚ŒOKã‚’æŠ¼ä¸‹ã—ã¦ä¸‹ã•ã„ã€‚<br>
![alt text](doc/Usage1.png)<br>
![alt text](doc/Usage2.png)<br>
ã“ã‚Œã¯ã€ã‚¯ãƒ©ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã§[ãƒˆãƒ¼ã‚¹ãƒˆ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ ã‚¹ã‚­ãƒ¼ãƒ](https://learn.microsoft.com/ja-jp/uwp/schemas/tiles/toastschema/schema-root)ã®ä½œæˆã«ä½¿ã„ã¾ã™ã€‚

3. æ¨™æº–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½œæˆã—ã€ä¸‹è¨˜ã®ã‚ˆã†ã«ç°¡å˜ãªã‚³ãƒ¼ãƒ‰ã‚’è¨˜è¿°ã—ã¦ã¿ã¾ã—ã‚‡ã†

```bas
Sub ShowToastTest()
    With New clsAppNotificationBuilder
        '1. ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£è¨­å®š
       .SetToastGenericTitleText = "Hello World"
       .SetToastGenericContentsText = "Test message"

        '2. ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè¡Œ
       .RunDll_ToastNotifierShow "Hello World"
    End With
End Sub
```

å®Ÿè¡Œçµæœã¯ã€ä¸‹è¨˜ã®ã¨ãŠã‚Šã§ã™<br>
![alt text](doc/Usage3.png)<br>
ã“ã®ã€ŒBook1ã€ã¯ã€Excelã®ãƒ–ãƒƒã‚¯åã¨é€£å‹•ã—ã¦ã„ã¾ã™ã€‚

# ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£èª¬æ˜

## AppUserModelID é–¢é€£

### AllowUse_InternetImage

HTTPä¸Šã®ç”»åƒã‚½ãƒ¼ã‚¹ã‚’ä½¿ã†ã‹æ±ºã‚ã¾ã™ã€‚<br>
ä¾‹ãˆã°ä»¥ä¸‹ã®è¨­å®šã§é€šçŸ¥ã‚’è¡¨ç¤ºã•ã›ã‚‹éš›â€¦â€¦<br>

```bas
Sub httpã‚½ãƒ¼ã‚¹ã®ç”»åƒä»˜ãé€šçŸ¥()
    With New clsAppNotificationBuilder
        .SetToastGenericTitleText = "ä¸Šéƒ¨ã«ç”»åƒã‚’è¡¨ç¤º"
        .SetToastGenericHeroImage = "https://pad.gungho.jp/member/img/graphic/illust/6828.png"


        Shell .GenerateCmd_ToastNotifierShow("withImageToast"), vbHide
    End With
End Sub
```

æ¬¡ã®ã‚ˆã†ãªè¡¨ç¤ºã«ãªã‚Šä¸Šæ‰‹ãã„ãã¾ã›ã‚“â€¦<br>
![alt text](doc/Ex_AppUserModelID1-1.png)<br>

ãã“ã§ã€ã€Œ.AllowUse_InternetImage = Trueã€ã‚’åŠ ãˆã‚‹ã¨â€¦

```bas
Sub httpã‚½ãƒ¼ã‚¹ã®ç”»åƒä»˜ãé€šçŸ¥()
    With New clsAppNotificationBuilder
        .AllowUse_InternetImage = True

        .SetToastGenericTitleText = "ä¸Šéƒ¨ã«ç”»åƒã‚’è¡¨ç¤º"
        .SetToastGenericHeroImage = "https://pad.gungho.jp/member/img/graphic/illust/6828.png"


        Shell .GenerateCmd_ToastNotifierShow("withImageToast"), vbHide
    End With
End Sub
```

æ­£ã—ãè¡¨ç¤ºã§ãã¾ã™ã€‚<br>
![alt text](doc/Ex_AppUserModelID1-2.png)<br>

ã“ã®HTTPä¸Šã®ç”»åƒã‚½ãƒ¼ã‚¹ã«é–¢ã™ã‚‹è©³ã—ã„æŒ™å‹•ã¯ã€[ã“ã¡ã‚‰](#allowuse_internetimage-ã®æŒ™å‹•)ã‚’å‚ç…§ä¸‹ã•ã„ã€‚

### SetAppUserModelID

ã“ã®é€šçŸ¥ã‚’ã©ã®AppUserModelIDã§å‡ºã™ã‹ã‚’è¨­å®šã—ã¾ã™ã€‚<br>
å­˜åœ¨ã—ãªã„(æœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«)AppUserModelIDã€ç„¡åŠ¹ãªæ–‡å­—åˆ—ã‚’æŒ‡å®šã™ã‚‹ã¨ã€ToastãŒç™ºè¡Œã•ã‚Œãªã„ã®ã§ã”æ³¨æ„ãã ã•ã„ã€‚<br>
æŒ‡å®šã—ãŸAppUserModelIDã«ã‚ˆã£ã¦ã¯ã€AllowUse_InternetImageã®è¨­å®šãŒåŠ¹ãã¾ã›ã‚“ã€‚<br>
ã“ã®ä»•æ§˜ã«ã¤ã„ã¦ã¯ã€[ã“ã¡ã‚‰](#AppUserModelID-ã®ä»•æ§˜)ã‚’å‚ç…§ä¸‹ã•ã„

#### è¨­å®šå€¤

Windows ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹AppUserModelID

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰

```bas
Sub TestSetAppUserModelID()
    Dim ActionCmd as String

    With New clsAppNotificationBuilder
        'ä»»æ„ã®AppUserModelID
        .SetAppUserModelID = "Microsoft.WindowsTerminal_8wekyb3d8bbwe!App"



        'ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ã‚’ç”Ÿæˆ(Windows PowerShellçµŒç”±ã§å®Ÿè¡Œã™ã‚‹å ´åˆ)
        ActionCmd = .GenerateCmd_ToastNotifierShow("By Terminal")

        'ã‚¿ã‚¤ãƒˆãƒ«è¨­å®š
        .SetToastGenericTitleText = "By Terminal"

        'é€šçŸ¥è¡¨ç¤º
        .RunDll_ToastNotifierShow "By Terminal"
        'Shell ActionCmd,vbHide
    End With
End Sub
```
![alt text](doc/Ex_AppUserModelID2.png)<br>
ä¸Šè¨˜ã®ä¾‹ã§ã¯ã€[Windows Terminal](https://apps.microsoft.com/detail/9n0dx20hk701) ã®AppUserModelIDã‚’è¨­å®šã—ã¾ã™ã€‚<br>
æ—¢å®šå€¤ã€è¨˜è¿°ãªã—ã¯ã€vbnullstringã§ã™ã€‚

## [toastè¦ç´ ](https://learn.microsoft.com/ja-jp/uwp/schemas/tiles/toastschema/element-toast)

### SetToastContent_Duration

ãƒˆãƒ¼ã‚¹ãƒˆãŒ[è¡¨ç¤ºã•ã‚Œã‚‹æ™‚é–“](https://learn.microsoft.com/ja-jp/uwp/schemas/tiles/toastschema/element-toast#:~:text=%E6%97%A2%E5%AE%9A%E5%80%A4-,duration,-%E3%83%88%E3%83%BC%E3%82%B9%E3%83%88%E3%81%8C%E8%A1%A8%E7%A4%BA)ã‚’è¨­å®šã—ã¾ã™ã€‚

#### è¨­å®šå€¤
| å€¤            | èª¬æ˜                            | 
| ------------- | ------------------------------- | 
| False(æ—¢å®šå€¤) | `short` ã¨åŒç­‰                     | 
| True          | `long` ã¨åŒç­‰<br>25sã€è¡¨ç¤ºã§ãã¾ã™ | 

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
```bas
Sub é•·ãè¡¨ç¤ºã•ã‚Œã‚‹é€šçŸ¥()
    Dim AppNotification As New clsAppNotificationBuilder
    Dim ActionCmd As String
    
    With AppNotification
        '25ç§’è¡¨ç¤ºã•ã‚Œã¾ã™
        .SetToastContent_Duration = True



        'ã‚¿ã‚¤ãƒˆãƒ«è¨­å®š
        .SetToastGenericTitleText = "25ç§’é–“ã€è¡¨ç¤º"

        'ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ã‚’ç”Ÿæˆ(Windows PowerShellçµŒç”±ã§å®Ÿè¡Œã™ã‚‹å ´åˆ)
        ActionCmd = .GenerateCmd_ToastNotifierShow("sample")

        'é€šçŸ¥è¡¨ç¤º
        'Shell ActionCmd, vbHide
        .RunDll_ToastNotifierShow "sample"
    End With
End Sub
```

![alt text](doc/Ex_Element-Toast1.png)

### SetToastContent_Launch

[ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥è‡ªä½“ã®ã‚¯ãƒªãƒƒã‚¯](https://learn.microsoft.com/ja-jp/uwp/schemas/tiles/toastschema/element-toast#:~:text=%E3%81%AA%E3%81%97-,launch,-%E3%83%88%E3%83%BC%E3%82%B9%E3%83%88%E9%80%9A%E7%9F%A5%E3%81%AB%E3%82%88%E3%81%A3%E3%81%A6)ã«ã‚ˆã£ã¦ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ã•ã‚Œã‚‹ã¨ãã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«æ¸¡ã•ã‚Œã‚‹æ–‡å­—åˆ—ã§ã™ã€‚
VBAã§ã¯ã€èµ·å‹•ã‚¹ã‚­ãƒ¼ãƒ(https:// , ms-excel:// ãªã©)ã‚’è¨­å®šã™ã‚‹ãã‚‰ã„ã®å½¹ç›®ã§ã™ã€‚
#### è¨­å®šå€¤
èµ·å‹•ã‚¹ã‚­ãƒ¼ãƒ
- https://
- ms-excel://

ãªã©

#### åˆ©ç”¨å¯èƒ½ãªå¼•æ•°
| å¼•æ•°å            | è§£èª¬                                                                                                                                                                                                                                                                                                                                                             | æ—¢å®šå€¤   | 
| ----------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------- | 
| ArgActivationType | ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç‰¹å®šã®æ“ä½œã‚’è¡Œã£ãŸéš›ã«ä½¿ç”¨ã•ã‚Œã‚‹ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ã®ç¨®é¡ã‚’æ±ºå®šã—ã¾ã™ã€‚<br>`taForeground` - ãƒ•ã‚©ã‚¢ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ ã‚¢ãƒ—ãƒªãŒèµ·å‹•ã—ã¾ã™ã€‚<br>`taBackground` - å¯¾å¿œã™ã‚‹ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ ã‚¿ã‚¹ã‚¯ãŒãƒˆãƒªã‚¬ãƒ¼ã•ã‚Œã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä¸­æ–­ã™ã‚‹ã“ã¨ãªããƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚<br>`taProtocol` - ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ã‚’ä½¿ç”¨ã—ã¦åˆ¥ã®ã‚¢ãƒ—ãƒªã‚’èµ·å‹•ã—ã¾ã™ã€‚ | protocol | 

> [!CAUTION]
> `taSystem` ã‚‚é¸æŠå¯èƒ½ã§ã™ãŒã€æ„å‘³ã‚’ãªã—ã¾ã›ã‚“ã€‚

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
```bas
Sub ãƒªãƒ³ã‚¯ã‚’é–‹ã()
    Dim AppNotification As New clsAppNotificationBuilder
    Dim ActionCmd As String
    
    With AppNotification
        'URLç­‰ã‚’æŒ‡å®š
        .SetToastContent_Launch(taProtocol) = "https://www.google.com/"



        'ã‚¿ã‚¤ãƒˆãƒ«è¨­å®š
        .SetToastGenericTitleText = "ã“ã®ãƒˆãƒ¼ã‚¹ãƒˆã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€æŒ‡å®šãƒªãƒ³ã‚¯ã«å¯¾å¿œã™ã‚‹ã‚¢ãƒ—ãƒªãŒèµ·å‹•"

        'ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ã‚’ç”Ÿæˆ(Windows PowerShellçµŒç”±ã§å®Ÿè¡Œã™ã‚‹å ´åˆ)
        ActionCmd = .GenerateCmd_ToastNotifierShow("sample")

        'é€šçŸ¥è¡¨ç¤º
        'Shell ActionCmd, vbHide
        .RunDll_ToastNotifierShow "sample"
    End With
End Sub
```

![alt text](doc/Ex_Element-Toast2.png)

### SetToastContent_DisplayTimestamp

Windows ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«ã‚ˆã£ã¦é€šçŸ¥ãŒå—ä¿¡ã•ã‚ŒãŸæ™‚åˆ»ã§ã¯ãªãã€é€šçŸ¥ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒå®Ÿéš›ã«é…ä¿¡ã•ã‚ŒãŸæ—¥æ™‚ã‚’è¡¨ã™ã‚«ã‚¹ã‚¿ãƒ  ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã§æ—¢å®šã®[ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰](https://learn.microsoft.com/ja-jp/windows/apps/design/shell/tiles-and-notifications/custom-timestamps-on-toasts?tabs=xml)ã—ã¾ã™ã€‚

#### è¨­å®šå€¤
Excelã®ã‚·ãƒªã‚¢ãƒ«å€¤

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
```bas
Sub ã‚¢ãƒ—ãƒªé€šçŸ¥ã®ã‚«ã‚¹ã‚¿ãƒ ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—()
    Dim AppNotification As New clsAppNotificationBuilder
    Dim ActionCmd As String
    
    With AppNotification
        'ã‚·ãƒªã‚¢ãƒ«å€¤ã§è¨­å®šã€‚åŸºæœ¬ã¯éå»ã«è¨­å®š
        .SetToastContent_DisplayTimestamp = Now() - 0.1



        .SetToastGenericTitleText = "Hello World"
        .SetToastGenericContentsText = "ã“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã€ä»¥å‰ã‹ã‚‰é€šçŸ¥ã•ã‚Œã¦ã¾ã—ãŸã€‚"
        .SetToastGenericAttributionText = "ã‚«ã‚¹ã‚¿ãƒ ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãƒ†ã‚¹ãƒˆ"

        'ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ã‚’ç”Ÿæˆ(Windows PowerShellçµŒç”±ã§å®Ÿè¡Œã™ã‚‹å ´åˆ)
        ActionCmd = .GenerateCmd_ToastNotifierShow("sample")

        'é€šçŸ¥è¡¨ç¤º
        'Shell ActionCmd, vbHide
        .RunDll_ToastNotifierShow "sample"
    End With
End Sub
```

![alt text](doc/Ex_Element-Toast3.png)

> [!NOTE]
> éå»ã®åº¦åˆã„ã«ã‚ˆã£ã¦ã€`hh:mm` â†’ æ›œæ—¥è¡¨è¨˜ â†’ `mm/dd` è¡¨è¨˜ã«ãªã‚Šã¾ã™ã€‚

### SetToastContent_Scenario

ãƒˆãƒ¼ã‚¹ãƒˆãŒä½¿ç”¨ã•ã‚Œã‚‹[ã‚·ãƒŠãƒªã‚ª](https://learn.microsoft.com/ja-jp/windows/apps/design/shell/tiles-and-notifications/adaptive-interactive-toasts?tabs=xml#scenarios)ã‚’è¨­å®šã—ã¾ã™ã€‚åˆ—æŒ™å‹ã«å¯¾å¿œã—ã¾ã™ã€‚

#### è¨­å®šå€¤
| ã‚·ãƒŠãƒªã‚ªå   | ä¸»ãªç‰¹å¾´                                                                                                                                                                                  | 
| ------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | 
| Default(æ—¢å®šå€¤)      | ä¸€èˆ¬çš„ãªæŒ™å‹•é€šçŸ¥                                                                                                                                                                      | 
| [Reminder](https://learn.microsoft.com/ja-jp/windows/apps/design/shell/tiles-and-notifications/adaptive-interactive-toasts?tabs=xml#reminders)     | ãƒ»é€šçŸ¥ã‚’æ°¸é ã«è¡¨ç¤ºã™ã‚‹ã€‚<br>ãƒ»actionè¦ç´ ãŒãªã„ã¨åŠ¹æœã¯ç™ºå‹•ã—ãªã„<br>ãƒ»ä»»æ„ã®é€šçŸ¥éŸ³ã«è¨­å®šå¯èƒ½<br>![reminder,alarm](doc/Ex_Element-Toast4-2.png)                                                                                          | 
| [Alarm](https://learn.microsoft.com/ja-jp/windows/apps/design/shell/tiles-and-notifications/adaptive-interactive-toasts?tabs=xml#alarms)        | ãƒ»é€šçŸ¥ã‚’æ°¸é ã«è¡¨ç¤ºã™ã‚‹ã€‚<br>ãƒ»actionè¦ç´ ãŒãªã„ã¨åŠ¹æœã¯ç™ºå‹•ã—ãªã„<br>ãƒ»é€šçŸ¥éŸ³ã¯ã€ã‚¢ãƒ©ãƒ¼ãƒ ç³»(Alarm)ã®ã¿<br>ãƒ»å¿œç­”ä¸å¯ãƒ¢ãƒ¼ãƒ‰ã§ã‚‚å¿…ãšè¡¨ç¤º<br>![reminder,alarm](doc/Ex_Element-Toast4-2.png)                                                 | 
| [IncomingCall](https://learn.microsoft.com/ja-jp/windows/apps/design/shell/tiles-and-notifications/adaptive-interactive-toasts?tabs=xml#incoming-calls) | ãƒ»é€šçŸ¥ã‚’æ°¸é ã«è¡¨ç¤ºã™ã‚‹ã€‚<br>ãƒ»actionè¦ç´ ãŒãªãã¦ã‚‚åŠ¹æœç™ºå‹•<br>ãƒ»é€šçŸ¥éŸ³ã¯å‘¼ã³å‡ºã—ç³»(Call)ã®ã¿<br>ãƒ»æœ€å¾Œã®ãƒœã‚¿ãƒ³ä½ç½®ã®ã¿ã€Windowsã®ãƒ†ãƒ¼ãƒè‰²ã«åŸºã¥ãç€è‰²ãŒæ–½ã•ã‚Œã€ä½ç½®ãŒå¿…ãšä¸‹å´ã«ãªã‚‹ã€‚<br>![reminder,alarm](doc/Ex_Element-Toast4-3.png) | 
| [Urgent](https://learn.microsoft.com/ja-jp/windows/apps/design/shell/tiles-and-notifications/adaptive-interactive-toasts?tabs=xml#important-notifications)       | ãƒ»é€šçŸ¥ã«æ„Ÿå˜†ç¬¦ãŒä»˜ä¸<br>ãƒ»å¿œç­”ä¸å¯ãƒ¢ãƒ¼ãƒ‰ã§ã®è¡¨ç¤º/éè¡¨ç¤ºã®ã€åˆ‡ã‚Šæ›¿ãˆå¯èƒ½<br>ãƒ»Build 22546 ä»¥é™ã®OS ã§æœ‰åŠ¹<br>![reminder,alarm](doc/Ex_Element-Toast4-4.png)                                                                                                               | 

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
```bas
Sub ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆ()
    Dim AppNotification As New clsAppNotificationBuilder
    Dim ActionCmd As String
    
    With AppNotification
        'ãƒˆãƒ¼ã‚¹ãƒˆã®ã‚·ãƒŠãƒªã‚ªã‚’è¨­å®š(ctrl + Space ã§å€™è£œã‚’è¡¨ç¤ºã§ãã¾ã™)
        .SetToastContent_Scenario = tsAlarm



        'ç´ä»˜ã‘ç”¨è­˜åˆ¥å­(è§£èª¬ã¯å¾Œè¿°)
        Const ReminderID As String = "ã‚¢ãƒ©ãƒ¼ãƒ "

        'selectè¦ç´ ã‚’æº–å‚™(è§£èª¬ã¯å¾Œè¿°)
        .SetToastSelectionBox(1, "1 åˆ†å¾Œ") = 1
        .SetToastSelectionBox(5, "5 åˆ†å¾Œ") = 2
        .SetToastSelectionBox(10, "10 åˆ†å¾Œ") = 3
        .SetToastSelectionBox(30, "30 åˆ†å¾Œ") = 4
        .SetToastSelectionBox(60, "1 æ™‚é–“å¾Œ") = 5

        'inputè¦ç´ ã‚’ä½œæˆã—ã€ä¸Šè¨˜ã§æº–å‚™ã—ãŸselectè¦ç´ ã‚’æŒ¿å…¥(è§£èª¬ã¯å¾Œè¿°)
        .SetIToastInput(ReminderID, True, , "é¸æŠè‚¢ã‹ã‚‰ã€å†é€šçŸ¥ã™ã‚‹æ™‚é–“ã‚’é¸æŠ", 10) = 1

        'å†é€šçŸ¥ç”¨ã¨ã€è§£é™¤ç”¨ã‚’ç”¨æ„(è§£èª¬ã¯å¾Œè¿°)
        .SetIToastActions("", "snooze", system, , , , ReminderID) = 1
        .SetIToastActions("", "dismiss", system) = 2

        'ãƒ†ã‚­ã‚¹ãƒˆè¦ç´ ã‚’ç”¨æ„
        .SetToastGenericTitleText = "Hello World"

        'ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ã‚’ç”Ÿæˆ(Windows PowerShellçµŒç”±ã§å®Ÿè¡Œã™ã‚‹å ´åˆ)
        ActionCmd = .GenerateCmd_ToastNotifierShow("sample")

        'é€šçŸ¥è¡¨ç¤º
        .RunDll_ToastNotifierShow "sample"
        'Shell ActionCmd, vbHide

    End With
End Sub
```

### SetToastContent_UseButtonStyle
toastè¦ç´ ã®[useButtonStyle](https://learn.microsoft.com/ja-jp/uwp/schemas/tiles/toastschema/element-toast#:~:text=%E3%81%AA%E3%81%97-,useButtonStyle,-%E3%82%B9%E3%82%BF%E3%82%A4%E3%83%AB%E4%BB%98%E3%81%8D%E3%83%9C%E3%82%BF%E3%83%B3)å±æ€§ã®è¨­å®šã‚’è¡Œã„ã¾ã™ã€‚<br>

#### è¨­å®šå€¤
| å€¤            | èª¬æ˜                            | 
| ------------- | ------------------------------- | 
| False(æ—¢å®šå€¤) | ã‚¹ã‚¿ã‚¤ãƒ«ä»˜ããƒœã‚¿ãƒ³ã‚’ä½¿ç”¨ã§ããªã„ã‚ˆã†ã«ã—ã¾ã™ã€‚å¾Œè¿°ã®[action è¦ç´ ](#SetIToastActions)ã® `hint-buttonStyle` å±æ€§ã«å½±éŸ¿ã—ã¾ã›ã‚“ã€‚ | 
| True          | ã‚¹ã‚¿ã‚¤ãƒ«ä»˜ããƒœã‚¿ãƒ³ã‚’ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚å¾Œè¿°ã®[action è¦ç´ ](#SetIToastActions)ã® `hint-buttonStyle` å±æ€§ã«å½±éŸ¿ã—ã¾ã™ã€‚ | 

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
```bas
Sub UseButtonStyle()
    Dim AppNotification As New clsAppNotificationBuilder
    Dim ActionCmd As String
    
    With AppNotification
        'ã‚¹ã‚¿ã‚¤ãƒ«ä»˜ããƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
        .SetToastContent_UseButtonStyle = True



        'ã‚¿ã‚¤ãƒˆãƒ«è¨­å®š
        .SetToastGenericTitleText = "ç·‘ã¨èµ¤ã®ãƒœã‚¿ãƒ³"

        'è¨­å®šæ–¹æ³•ã¯å¾Œè¿°
        .SetIToastActions("Green", "", , , , , , tbsSuccess) = 1
        .SetIToastActions("Red", "", , , , , , tbsCritical) = 2

        'ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ã‚’ç”Ÿæˆ(Windows PowerShellçµŒç”±ã§å®Ÿè¡Œã™ã‚‹å ´åˆ)
        ActionCmd = .GenerateCmd_ToastNotifierShow("sample")

        'é€šçŸ¥è¡¨ç¤º
        'Shell ActionCmd, vbHide
        .RunDll_ToastNotifierShow "sample"
    End With
End Sub
```
![alt text](doc/Ex_Element-Toast5.png)

## [imageè¦ç´ ](https://learn.microsoft.com/ja-jp/uwp/schemas/tiles/toastschema/element-image)
### SetToastGenericAppLogo
imageè¦ç´ ã®ã†ã¡ã€AppLogo(appLogoOverride)ã«è¨­å®šã™ã‚‹ç”»åƒã®ãƒ‘ã‚¹ã¨ã€ä¸¸ã„ãƒ­ã‚´ãƒ•ãƒ©ã‚°ã®è¨­å®šã‚’è¡Œã„ã¾ã™ã€‚<br>

#### è¨­å®šå€¤
ãƒ­ã‚´ç”»åƒã®ãƒ‘ã‚¹æŒ‡å®š
- ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ã‚¹(C:\\)
- HTTPã‚½ãƒ¼ã‚¹(https://)

#### åˆ©ç”¨å¯èƒ½ãªå¼•æ•°
| å¼•æ•°å             | èª¬æ˜                                                                                                           | æ—¢å®šå€¤       | 
| ------------------ | -------------------------------------------------------------------------------------------------------------- | ------------ | 
| Arg_LogoCircle     | `True` ç”»åƒã¯å††ã«ãƒˆãƒªãƒŸãƒ³ã‚°ã•ã‚Œã¾ã™ã€‚<br>`False` ç”»åƒã¯ãƒˆãƒªãƒŸãƒ³ã‚°ã•ã‚Œãšã€æ­£æ–¹å½¢ã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚              | False        | 
| Flag_addImageQuery | Windows ãŒãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã§æŒ‡å®šã•ã‚ŒãŸã‚¤ãƒ¡ãƒ¼ã‚¸ URI ã«ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ã‚’è¿½åŠ ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã«ã¯ã€"true" ã«è¨­å®šã—ã¾ã™ã€‚ | False        | 
| Arg_Alt            | æ”¯æ´æŠ€è¡“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã®ç”»åƒã®èª¬æ˜ã€‚                                                                      | vbnullstring | 

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
```bas
Sub ãƒ­ã‚´ç”»åƒ()
    Dim AppNotification As New clsAppNotificationBuilder
    Dim ActionCmd As String
    
    With AppNotification
        'ãƒ­ã‚´ç”»åƒã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚(Arg_LogoCircle=False)
        .SetToastGenericAppLogo = "C:\Windows\SystemApps\Microsoft.XboxGameCallableUI_cw5n1h2txyewy\Assets\Logo.scale-100.png"

        'ãƒ­ã‚´ç”»åƒã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã€å††ã«ãƒˆãƒªãƒŸãƒ³ã‚°ã€‚(Arg_LogoCircle=True)
        '.SetToastGenericAppLogo(True) = "C:\Windows\SystemApps\Microsoft.XboxGameCallableUI_cw5n1h2txyewy\Assets\Logo.scale-100.png"



        'ã‚¿ã‚¤ãƒˆãƒ«è¨­å®š
        .SetToastGenericTitleText = "ãƒ­ã‚´ç”»åƒãƒ†ã‚¹ãƒˆ"

        'ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ã‚’ç”Ÿæˆ(Windows PowerShellçµŒç”±ã§å®Ÿè¡Œã™ã‚‹å ´åˆ)
        ActionCmd = .GenerateCmd_ToastNotifierShow("sample")

        'é€šçŸ¥è¡¨ç¤º
        .RunDll_ToastNotifierShow "sample"
        'Shell ActionCmd, vbHide
    End With
End Sub
```

| Arg_LogoCircle=False | Arg_LogoCircle=True | 
| -------------------- | ------------------- | 
| ![æ­£æ–¹å½¢](doc/Ex_Element-Image1-1.png)                   | ![å††ã«ãƒˆãƒªãƒŸãƒ³ã‚°](doc/Ex_Element-Image1-2.png)                  | 

### SetToastGenericInlineImage
imageè¦ç´ ã®ã†ã¡ã€ãƒ†ã‚­ã‚¹ãƒˆè¦ç´ ã®å¾Œã«è¡¨ç¤ºã™ã‚‹ç”»åƒãƒ‘ã‚¹ã¨ã€ä¸¸ã„ãƒ­ã‚´ãƒ•ãƒ©ã‚°ã®è¨­å®šã‚’è¡Œã„ã¾ã™ã€‚<br>
å…ˆã»ã©ã¨åŒæ§˜ã€ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ç”»åƒã®ãƒ‘ã‚¹æŒ‡å®šã‚‚ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ã‚¹(C:\\)ã€HTTPã‚½ãƒ¼ã‚¹ã«å¯¾å¿œã—ã¦ã¾ã™ã€‚<br>
å¼•æ•°ã®å†…å®¹ã‚‚åŒæ§˜ã®ãŸã‚ã€çœç•¥ã—ã¾ã™ã€‚

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
```bas
Sub ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ç”»åƒ()
    Dim AppNotification As New clsAppNotificationBuilder
    Dim ActionCmd As String
    
    With AppNotification
        'é€šå¸¸
        .SetToastGenericInlineImage(False, , "win ã®å£ç´™") = "C:\Windows\Web\Screen\img100.jpg"
        'å††ã«ãƒˆãƒªãƒŸãƒ³ã‚°
        ''.SetToastGenericInlineImage(True, , "win ã®å£ç´™") = "C:\Windows\Web\Screen\img100.jpg"



        'ã‚¿ã‚¤ãƒˆãƒ«è¨­å®š
        .SetToastGenericTitleText = "ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ç”»åƒãƒ†ã‚¹ãƒˆ"

        'ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ã‚’ç”Ÿæˆ(Windows PowerShellçµŒç”±ã§å®Ÿè¡Œã™ã‚‹å ´åˆ)
        ActionCmd = .GenerateCmd_ToastNotifierShow("sample")

        'é€šçŸ¥è¡¨ç¤º
        'Shell ActionCmd, vbHide
        .RunDll_ToastNotifierShow "sample"
    End With
End Sub
```

| Arg_LogoCircle=False | Arg_LogoCircle=True | 
| -------------------- | ------------------- | 
| ![æ­£æ–¹å½¢](doc/Ex_Element-Image2-1.png)                   | ![å††ã«ãƒˆãƒªãƒŸãƒ³ã‚°](doc/Ex_Element-Image2-2.png)                  | 

### SetToastGenericHeroImage
ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚¤ãƒ¡ãƒ¼ã‚¸ã¨ã—ã¦è¡¨ç¤ºã•ã›ã‚‹ç”»åƒã‚’è¨­å®šã—ã¾ã™ã€‚<br>

#### è¨­å®šå€¤
ãƒ’ãƒ¼ãƒ­ãƒ¼ç”»åƒã®ãƒ‘ã‚¹æŒ‡å®š
- ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ã‚¹(C:\\)
- HTTPã‚½ãƒ¼ã‚¹(https://)

#### åˆ©ç”¨å¯èƒ½ãªå¼•æ•°
| å¼•æ•°å             | èª¬æ˜                                                                                                           | æ—¢å®šå€¤       | 
| ------------------ | -------------------------------------------------------------------------------------------------------------- | ------------ | 
| Flag_addImageQuery | Windows ãŒãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã§æŒ‡å®šã•ã‚ŒãŸã‚¤ãƒ¡ãƒ¼ã‚¸ URI ã«ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ã‚’è¿½åŠ ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã«ã¯ã€"true" ã«è¨­å®šã—ã¾ã™ã€‚ | False        | 
| Arg_Alt            | æ”¯æ´æŠ€è¡“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã®ç”»åƒã®èª¬æ˜ã€‚                                                                      | vbnullstring | 

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
```bas
Sub ä¸Šéƒ¨ã«ç”»åƒ()
    Dim AppNotification As New clsAppNotificationBuilder
    Dim ActionCmd As String
    
    With AppNotification
        'ä¸Šéƒ¨ã«ç”»åƒã‚’é…ç½®ã—ã¾ã™
        .SetToastGenericHeroImage(, "win11å£ç´™") = "C:\Windows\Web\Screen\img100.jpg"



        'ã‚¿ã‚¤ãƒˆãƒ«è¨­å®š
        .SetToastGenericTitleText = "ä¸Šéƒ¨ã«ç”»åƒã‚’é…ç½®"

        'ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ã‚’ç”Ÿæˆ(Windows PowerShellçµŒç”±ã§å®Ÿè¡Œã™ã‚‹å ´åˆ)
        ActionCmd = .GenerateCmd_ToastNotifierShow("sample")

        'é€šçŸ¥è¡¨ç¤º
        'Shell ActionCmd, vbHide
        .RunDll_ToastNotifierShow "sample"
    End With
End Sub
```

![alt text](doc/Ex_Element-Image3.png)

## [textè¦ç´ ](https://learn.microsoft.com/ja-jp/uwp/schemas/tiles/toastschema/element-text)
ã‚¢ãƒ—ãƒªé€šçŸ¥ã§ä½¿ç”¨ã•ã‚Œã‚‹ãƒ†ã‚­ã‚¹ãƒˆã‚’æŒ‡å®šã—ã¾ã™ã€‚

#### è¨­å®šå€¤
ä»»æ„ã®æ–‡å­—åˆ—ã€‚
| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å                   | é…ç½®ä½ç½® | æœ€å¤§è¡Œæ•° | 
| ----------------------------- | -------- | -------- | 
| SetToastGenericTitleText     | ã‚¿ã‚¤ãƒˆãƒ« | 2è¡Œ      | 
| SetToastGenericContentsText      | å†…å®¹     | 4è¡Œ      | 
| SetToastGenericAttributionText | ä¸‹éƒ¨     | 2è¡Œ      | 

### åˆ©ç”¨å¯èƒ½ãªå¼•æ•°
| å¼•æ•°å             | èª¬æ˜                                                                                                           | æ—¢å®šå€¤       | 
| ------------------ | -------------------------------------------------------------------------------------------------------------- | ------------ | 
| HintCallScenarioCenterAlign | æ¨ªä¸­å¤®æƒãˆã®é…ç½®ã«ã™ã‚‹è¨­å®šã§ã™ã€‚`True` ã«ã—ã¤ã¤ã€ã‚·ãƒŠãƒªã‚ªãƒ¢ãƒ¼ãƒ‰ã‚’ `tsIncomingCall` ã«ã—ãªã„ã¨åŠ¹æœã‚ã‚Šã¾ã›ã‚“ã€‚ | False        | 

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
```bas
Sub æœ€å¤§è¡Œæ•°ãƒ†ã‚­ã‚¹ãƒˆ()
    Dim AppNotification As New clsAppNotificationBuilder
    Dim ActionCmd As String

    With AppNotification
        'ãƒ†ã‚­ã‚¹ãƒˆè¨­å®š
        .SetToastGenericTitleText(True) = "ã‚¿ã‚¤ãƒˆãƒ« 1Line" & vbCrLf & "ã‚¿ã‚¤ãƒˆãƒ« 2Line" & vbCrLf & "ã‚¿ã‚¤ãƒˆãƒ« 3Line"
        .SetToastGenericContentsText(True) = "ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ 1Line" & vbCrLf & "ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ 2Line" & vbCrLf & "ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ 3Line" & vbCrLf & "ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ 4Line" & vbCrLf & "ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ 5Line"
        .SetToastGenericAttributionText(True) = "ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚½ãƒ¼ã‚¹ 1Line" & vbCrLf & "ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚½ãƒ¼ã‚¹ 2Line" & vbCrLf & "ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚½ãƒ¼ã‚¹ 3Line"



        'ä¸­å¤®æƒãˆã«ã™ã‚‹ã¨ã
        '.SetToastContent_Scenario = tsIncomingCall

        'ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ã‚’ç”Ÿæˆ(Windows PowerShellçµŒç”±ã§å®Ÿè¡Œã™ã‚‹å ´åˆ)
        ActionCmd = .GenerateCmd_ToastNotifierShow("sample")

        'é€šçŸ¥è¡¨ç¤º
        'Shell ActionCmd, vbHide
        .RunDll_ToastNotifierShow "sample"
    End With
end sub
```

| HintCallScenarioCenterAlign = False             | HintCallScenarioCenterAlign = True ã‹ã¤ã€SetToastContent_Scenario = tsIncomingCall |
| ------------------------------------------------- | --------------------------------------- |
| ![alt text](doc/Ex_Element-text1-1.png)           | ![alt text](doc/Ex_Element-text1-2.png) |

## [audioè¦ç´ ](https://learn.microsoft.com/ja-jp/uwp/schemas/tiles/toastschema/element-audio)
### SetToastAudio
ã‚¢ãƒ—ãƒªé€šçŸ¥ã‚’è¡¨ç¤ºã™ã‚‹ã¨ãã«å†ç”Ÿã™ã‚‹ã‚µã‚¦ãƒ³ãƒ‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚ ãƒŸãƒ¥ãƒ¼ãƒˆã‚‚å¯¾å¿œã—ã¦ã¾ã™ã€‚<br>
ãŸã ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ä¸Šã®éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚„ URLã®æŒ‡å®šã¯ä½¿ãˆã¾ã›ã‚“ã€‚ã‚·ã‚¹ãƒ†ãƒ ã§æ±ºã‚ã‚‰ã‚ŒãŸé€šçŸ¥éŸ³ã®ã¿è¨­å®šå¯èƒ½ã§ã™ã€‚

#### è¨­å®šå€¤
è¨­å®šå¯èƒ½ãªé€šçŸ¥éŸ³ã¯ã€[ã“ã¡ã‚‰](https://learn.microsoft.com/ja-jp/uwp/schemas/tiles/toastschema/element-audio#:~:text=false-,src,-%E6%97%A2%E5%AE%9A%E3%81%AE%E3%82%B5%E3%82%A6%E3%83%B3%E3%83%89)ã‚’ã©ã†ãã€‚<br>
ã¾ãŸã€False ã§æŒ‡å®šã™ã‚‹ã¨ã€ãƒŸãƒ¥ãƒ¼ãƒˆæ‰±ã„ã«ãªã‚Šã¾ã™ã€‚

#### åˆ©ç”¨å¯èƒ½ãªå¼•æ•°
| å¼•æ•°å             | èª¬æ˜                                                                                                           | æ—¢å®šå€¤       | 
| ------------------ | -------------------------------------------------------------------------------------------------------------- | ------------ | 
| ArgLoop            | ãƒˆãƒ¼ã‚¹ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹é™ã‚Šã€ã‚µã‚¦ãƒ³ãƒ‰ã‚’ç¹°ã‚Šè¿”ã™å ´åˆã¯ `true` ã«è¨­å®šã—ã¾ã™ã€‚<br> 1 å›ã ã‘å†ç”Ÿã™ã‚‹å ´åˆã¯ `false`  | False        | 

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
```bas
Sub é€šçŸ¥éŸ³å¤‰æ›´ãƒ†ã‚¹ãƒˆ()
    Dim AppNotification As New clsAppNotificationBuilder
    Dim ActionCmd As String

    With AppNotification
        'é€šçŸ¥éŸ³è¨­å®š(ctrl + Spaceã€€ã§å€™è£œãŒå‡ºã¾ã™)
        .SetToastAudio = NotificationLoopingAlarm01



        'ã‚¿ã‚¤ãƒˆãƒ«è¨­å®š
        .SetToastGenericTitleText = "é€šçŸ¥éŸ³å¤‰æ›´"

        'ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ã‚’ç”Ÿæˆ(Windows PowerShellçµŒç”±ã§å®Ÿè¡Œã™ã‚‹å ´åˆ)
        ActionCmd = .GenerateCmd_ToastNotifierShow("sample")

        'é€šçŸ¥è¡¨ç¤º
        'Shell ActionCmd, vbHide
        .RunDll_ToastNotifierShow "sample"
    End With
End Sub
```

## [actionè¦ç´ ](https://learn.microsoft.com/ja-jp/uwp/schemas/tiles/toastschema/element-action)
### SetIToastActions
ãƒˆãƒ¼ã‚¹ãƒˆã«è¡¨ç¤ºã•ã‚Œã‚‹ãƒœã‚¿ãƒ³ã‚’æŒ‡å®šã—ã¾ã™ã€‚
#### è¨­å®šå€¤
ãƒœã‚¿ãƒ³ã®é…ç½®é †ã€‚1~5ã¾ã§æœ‰åŠ¹ã§ã™ã€‚

#### åˆ©ç”¨å¯èƒ½ãªå¼•æ•°
| å¼•æ•°å             | èª¬æ˜                                                                                                                                                                                                                                                                                                                                                             | æ—¢å®šå€¤                       | 
| ------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------- | 
| ArgContent         | ãƒœã‚¿ãƒ³ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„                                                                                                                                                                                                                                                                                                                                     | â€»å¿…é ˆé …ç›®                   | 
| ArgArguments       | ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã“ã®ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸå ´åˆã«ã‚¢ãƒ—ãƒªãŒå¾Œã‹ã‚‰å—ã‘å–ã‚‹ã€ã‚¢ãƒ—ãƒªã§å®šç¾©ã•ã‚ŒãŸå¼•æ•°ã®æ–‡å­—åˆ—ã§ã™ã€‚                                                                                                                                                                                                                                                             | â€»å¿…é ˆé …ç›®ã ãŒã€ç©ºæ–‡å­—ã§ã‚‚OK | 
| ArgActivationType  | ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç‰¹å®šã®æ“ä½œã‚’è¡Œã£ãŸéš›ã«ä½¿ç”¨ã•ã‚Œã‚‹ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ã®ç¨®é¡ã‚’æ±ºå®šã—ã¾ã™ã€‚<br>`tsForeground` ãƒ•ã‚©ã‚¢ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ ã‚¢ãƒ—ãƒªãŒèµ·å‹•ã—ã¾ã™ã€‚<br>`tsBackground` å¯¾å¿œã™ã‚‹ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ ã‚¿ã‚¹ã‚¯ãŒãƒˆãƒªã‚¬ãƒ¼ã•ã‚Œã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä¸­æ–­ã™ã‚‹ã“ã¨ãªããƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚<br>`tsProtocol`ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ã‚’ä½¿ç”¨ã—ã¦åˆ¥ã®ã‚¢ãƒ—ãƒªã‚’èµ·å‹•ã—ã¾ã™ã€‚ <br>`tsSystem` ArgArgumentsã«ç‰¹å®šã®æ–‡å­—åˆ—ã‚’å…¥ã‚Œã‚‹ã¨ã€ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼æ©Ÿèƒ½ãŒä½¿ãˆã¾ã™ã€‚(å¾Œè¿°)| protocol                     | 
| ArgPendingUpdate   | ãƒ»TRUEï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒˆãƒ¼ã‚¹ãƒˆä¸Šã®ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€é€šçŸ¥ã¯ "ä¿ç•™ä¸­ã®æ›´æ–°" è¡¨ç¤ºçŠ¶æ…‹ã®ã¾ã¾ã§ã™ã€‚ ã“ã® "æ›´æ–°ã®ä¿ç•™ä¸­" ã®è¡¨ç¤ºçŠ¶æ…‹ãŒé•·æ™‚é–“ç¶šãã“ã¨ã‚’é¿ã‘ã‚‹ãŸã‚ã€ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ ã‚¿ã‚¹ã‚¯ã‹ã‚‰å³åº§ã«ãƒˆãƒ¼ã‚¹ãƒˆã‚’æ›´æ–°ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚<br>ãƒ»FALSEï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒˆãƒ¼ã‚¹ãƒˆã«å¯¾ã—ã¦æ“ä½œã‚’è¡Œã†ã¨ã€ãƒˆãƒ¼ã‚¹ãƒˆãŒç„¡è¦–ã•ã‚Œã¾ã™ã€‚                                                    | FALSE                        | 
| ArgContextMenu     | `TRUE` ãƒˆãƒ¼ã‚¹ãƒˆ ãƒœã‚¿ãƒ³ã§ã¯ãªãã€ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«è¿½åŠ ã•ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«ãªã‚Šã¾ã™ã€‚<br>`FALSE` å¾“æ¥é€šã‚Šã€ãƒˆãƒ¼ã‚¹ãƒˆ ãƒœã‚¿ãƒ³ã«é…ç½®                                                                                                                                                                                         | FALSE                        | 
| ArgIcon            | ãƒˆãƒ¼ã‚¹ãƒˆ ãƒœã‚¿ãƒ³ ã‚¢ã‚¤ã‚³ãƒ³ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ ã‚½ãƒ¼ã‚¹ã® URIã€‚<br>ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ã‚¹ã€HTTPã‚½ãƒ¼ã‚¹ã«å¯¾å¿œã—ã¾ã™ã€‚                                                                                                                                                                                                                                                                      | vbnullstring                 | 
| ArgHintInputId     | å¾Œè¿°ã® Inputè¦ç´ ã®IDå±æ€§ã‚’æŒ‡å®šã™ã‚‹ã¨ã€ãã®Inputè¦ç´ ã®æ¨ªã«ãƒœã‚¿ãƒ³ãŒé…ç½®ã•ã‚Œã¾ã™ã€‚                                                                                                                                                                                                                                                                                                       | vbnullstring                 | 
| ArgHintButtonStyle | ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ«ã€‚<br>äº‹å‰ã«[toastè¦ç´ ã®useButtonStyleå±æ€§](#SetToastContent_UseButtonStyle)ã«true ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚<br><br>`tbsSuccess` ç·‘<br>`tbsCritical` èµ¤<br>`NoStyle` è‰²ãªã—                                                                                                                                                                                                             | NoStyle                      | 
| ArgHintToolTip     | ãƒœã‚¿ãƒ³ã«ç©ºã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æ–‡å­—åˆ—ãŒã‚ã‚‹å ´åˆã®ãƒœã‚¿ãƒ³ã®ãƒ’ãƒ³ãƒˆã€‚                                                                                                                                                                                                                                                                                                         | vbnullstring                 | 

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
```bas
Sub MakeActionTest()
    Dim AppNotification As New clsAppNotificationBuilder
    Dim ActionCmd As String

    With AppNotification
        'ãƒœã‚¿ãƒ³ä½œæˆ
        .SetIToastActions("Green", "", , , , , , tbsSuccess) = 1
        
        'ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼å´ã«ç§»ã™
        .SetIToastActions("ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«ã‚ã‚Šã¾ã™", "", , , True) = 2
        
        'ãƒœã‚¿ãƒ³ã«ã‚«ãƒ¼ã‚½ãƒ«ã‚’ã‚ã¦ã‚‹ã¨ToolTipè¡¨ç¤ºã—ã€ã‚¢ã‚¤ã‚³ãƒ³ã‚»ãƒƒãƒˆ
        .SetIToastActions("", "ms-search://Search", , , , "C:\Windows\IdentityCRL\WLive48x48.png", , , "ã‚¯ãƒªãƒƒã‚¯ã§ã€æ¤œç´¢ã‚’é–‹ã") = 3
        
        'ã“ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ä¸‹ã™ã‚‹ã¨ã€Youtubeã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™
        .SetIToastActions("YouTubeé–‹ã", "https://www.youtube.com/", , , , , , tbsCritical) = 4



        'ã‚¹ã‚¿ã‚¤ãƒ«ä»˜ããƒœã‚¿ãƒ³ã®æœ‰åŠ¹åŒ–
        .SetToastContent_UseButtonStyle = True

        'ã‚¿ã‚¤ãƒˆãƒ«è¨­å®š
        .SetToastGenericTitleText = "ActionTest"

        'ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ã‚’ç”Ÿæˆ(Windows PowerShellçµŒç”±ã§å®Ÿè¡Œã™ã‚‹å ´åˆ)
        ActionCmd = .GenerateCmd_ToastNotifierShow("sample")

        'é€šçŸ¥è¡¨ç¤º
        'Shell ActionCmd, vbHide
        .RunDll_ToastNotifierShow "sample"
    End With
End Sub
```

![alt text](doc/Ex_Element-Action1-1.png) ![alt text](doc/Ex_Element-Action1-2.png)

## [subgroupè¦ç´ ](https://learn.microsoft.com/ja-jp/uwp/schemas/tiles/toastschema/element-subgroup)

é«˜åº¦ãªé€šçŸ¥ã®è¡¨ç¾ã‚’è¡Œã†ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚<br>
ãã®ãŸã‚ã€ä»–ã®è¨­å®šã¨ã¯è¤‡é›‘ãªæ–¹å¼ã§ã®è¨­å®šã¨ãªã‚Šã¾ã™ã€‚ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã‚Œã°ãŠãŠã‚ˆãã€æŠŠæ¡ã§ãã‚‹ã¨æ€ã„ã¾ã™ã€‚

### [AddAdaptiveSubgroupText](https://learn.microsoft.com/ja-jp/windows/apps/design/shell/tiles-and-notifications/toast-schema#adaptivetext)

ãƒ†ã‚­ã‚¹ãƒˆè¦ç´ ã‚’è¿½åŠ ã—ã¾ã™ã€‚ã‚ã‚‹ç¨‹åº¦ã®æ›¸å¼è¨­å®šãŒå¯èƒ½ã§ã™ã€‚

#### è¨­å®šå€¤
ä»»æ„ã®æ–‡å­—åˆ—<br>
æŠ˜ã‚Šè¿”ã—ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯å¼•æ•°ï¼šHintWrap ã‚’ True ã«ã™ã‚‹ã“ã¨ã€‚

#### åˆ©ç”¨å¯èƒ½ãªå¼•æ•°
| å¼•æ•°å            | èª¬æ˜                                                                                                                           | æ—¢å®šå€¤            | 
| ----------------- | ------------------------------------------------------------------------------------------------------------------------------ | ----------------- | 
| [HintStyle](https://learn.microsoft.com/ja-jp/windows/apps/design/shell/tiles-and-notifications/toast-schema#adaptivetextstyle)             | æ›¸å¼è¨­å®šã‚’æ–½ã—ã¾ã™ã€‚ | Default | 
| HintWrap      | ãƒ»Trueï¼šãƒ†ã‚­ã‚¹ãƒˆã®æŠ˜ã‚Šè¿”ã—ãŒæœ‰åŠ¹ã«ãªã‚Šã¾ã™ã€‚<br>ãƒ»Falseï¼šãƒ†ã‚­ã‚¹ãƒˆã®æŠ˜ã‚Šè¿”ã—ãŒç„¡åŠ¹ã«ãªã‚Šã¾ã™ã€‚(æœ€å¤§è¡Œæ•°1è¡Œ)                                        | False | 
| HintMaxLines | è¡¨ç¤ºãŒè¨±å¯ã•ã‚Œã‚‹ã€ãƒ†ã‚­ã‚¹ãƒˆè¦ç´ ã®æœ€å¤§è¡Œæ•°ã§ã™ã€‚ | 0(ä¸Šé™ãªã—) | 
| HintMinLines | è¡¨ç¤ºã™ã‚‹å¿…è¦ã®ã‚ã‚‹ã€ãƒ†ã‚­ã‚¹ãƒˆè¦ç´ ã®æœ€å°è¡Œæ•°ã§ã™ã€‚ | 0 | 
| [HintAlign](https://learn.microsoft.com/ja-jp/windows/apps/design/shell/tiles-and-notifications/toast-schema#adaptivetextalign) | ãƒ†ã‚­ã‚¹ãƒˆã®æ°´å¹³æ–¹å‘ã®é…ç½®ã‚’æŒ‡å®šã—ã¾ã™ã€‚             | Default | 
| Language | "en-US" ã‚„ "ja-JP" ã®ã‚ˆã†ã« BCP-47 è¨€èªã‚¿ã‚°ã¨ã—ã¦æŒ‡å®šã•ã‚Œã¾ã™ã€‚ | vbnullstring | 

### [AddAdaptiveSubgroupImage](https://learn.microsoft.com/ja-jp/windows/apps/design/shell/tiles-and-notifications/toast-schema#adaptiveimage)
ç”»åƒè¦ç´ ã‚’è¿½åŠ ã—ã¾ã™ã€‚

#### è¨­å®šå€¤
ç”»åƒãƒ‘ã‚¹<br>
ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ã‚¹ã€httpã‚½ãƒ¼ã‚¹ãŒã¤ã‹ãˆã¾ã™ã€‚

#### åˆ©ç”¨å¯èƒ½ãªå¼•æ•°
| å¼•æ•°å            | èª¬æ˜                                                                                                                           | æ—¢å®šå€¤            | 
| ----------------- | ------------------------------------------------------------------------------------------------------------------------------ | ----------------- | 
| [HintCrop](https://learn.microsoft.com/ja-jp/windows/apps/design/shell/tiles-and-notifications/toast-schema#adaptiveimagecrop)  | ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ç›®çš„ã®ãƒˆãƒªãƒŸãƒ³ã‚°ã‚’åˆ¶å¾¡ã—ã¾ã™ã€‚ | Default | 
| HintRemoveMargin      | ãƒ»Trueï¼š8 ãƒ”ã‚¯ã‚»ãƒ«ã®ä½™ç™½ã‚’ç”Ÿæˆ(ãƒãƒ¼ã‚¸ãƒ³å‡¦ç†)<br>ãƒ»Falseï¼šãƒãƒ¼ã‚¸ãƒ³å‡¦ç†ãªã—                                       | True | 
| [HintAlign](https://learn.microsoft.com/ja-jp/windows/apps/design/shell/tiles-and-notifications/toast-schema#adaptiveimagealign) | ç”»åƒã®æ°´å¹³æ–¹å‘ã®é…ç½®ã§ã™ã€‚ | Default  | 
| AlternateText | ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å¯¾å¿œç›®çš„ã§ä½¿ç”¨ã•ã‚Œã‚‹ã€ç”»åƒã‚’èª¬æ˜ã™ã‚‹ä»£æ›¿ãƒ†ã‚­ã‚¹ãƒˆã§ã™ã€‚ | Default  | 
| AddImageQuery | ãƒ»Trueï¼šã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ä»˜ãURLã‚’è¨±å¯<br>ãƒ»Falseï¼šã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ä»˜ãURLã‚’æ‹’å¦  | False  | 

### [AddAdaptiveSubgroup](https://learn.microsoft.com/ja-jp/windows/apps/design/shell/tiles-and-notifications/toast-schema#adaptivesubgroup)
äº‹å‰ã«ã€AddAdaptiveSubgroupTextã€AddAdaptiveSubgroupImage ã‚’å‘¼ã³å‡ºã—ãŸç‰©ã«å¯¾ã—ã¦ã€Subgroupè¦ç´ ã«æŒ¿å…¥ã—ã¾ã™ã€‚<br>
ãªãŠã€ã“ã‚Œã‚’å‘¼ã³å‡ºã™ã¨ä»¥å‰è¨­å®šã—ãŸã€subgroupè¦ç´ å†…ã®text,imageè¦ç´ ã¯ãƒªã‚»ãƒƒãƒˆã•ã‚Œã¾ã™ã€‚
#### åˆ©ç”¨å¯èƒ½ãªå¼•æ•°
| å¼•æ•°å            | èª¬æ˜                                                                                                                           | 
| ----------------- | ------------------------------------------------------------------------------------------------------------------------------ | 
| HintWeight        | åˆ—ã®å¹…ã‚’åˆ¶å¾¡ã—ã¾ã™ã€‚         |
| [HintTextStacking](https://learn.microsoft.com/ja-jp/windows/apps/design/shell/tiles-and-notifications/toast-schema#adaptivesubgrouptextstacking)  | å‚ç›´æ–¹å‘ã®é…ç½®ã‚’åˆ¶å¾¡ã—ã¾ã™ã€‚  |

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã¯ã€é€±é–“å¤©æ°—äºˆå ±ã£ã½ã„é€šçŸ¥ã‚’ä½œæˆã—ã¾ã™

> [!TIP]
> `AddAdaptiveSubgroupText` ã‹ `AddAdaptiveSubgroupImage` ã‚’é †ç•ªã«æ›¸ãã€`AddAdaptiveSubgroup` ã§ã€1ã¤ã®ã‚°ãƒ«ãƒ¼ãƒ—ãŒå‡ºæ¥ä¸ŠãŒã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚

```bas
Sub å¤©æ°—äºˆå ±ãƒ©ã‚¤ã‚¯()
    Dim AppNotification As New clsAppNotificationBuilder
    Dim ActionCmd As String
    
    With AppNotification
        'ãƒãƒƒãƒˆä¸Šã®ç”»åƒã‚’ä½¿ã†ã‚ˆã†ã«ã™ã‚‹
        .AllowUse_InternetImage = True
        
        'ãƒ«ãƒ¼ãƒˆURLã‚’è¨­å®š
        .SetToastBindingGeneric = "https://weathernews.jp/s/topics/img/wxicon/"
        
        'ã‚¿ã‚¤ãƒˆãƒ«
        .SetToastGenericTitleText = "æ¥é€±ã®å¤©æ°—äºˆå ±"
        .SetToastHeader(vbNullString) = ""
        
        '1subgroup
        .AddAdaptiveSubgroupText(, , , , TextAlign_Center) = "Mon"
        .AddAdaptiveSubgroupImage = "100.png"
        .AddAdaptiveSubgroupText(, , , , TextAlign_Center) = "29â„ƒ"
        .AddAdaptiveSubgroupText(TextStyle_CaptionSubtle, , , , TextAlign_Center) = "23â„ƒ"
        .AddAdaptiveSubgroup (1)

        '2subgroup
        .AddAdaptiveSubgroupText(, , , , TextAlign_Center) = "Tue"
        .AddAdaptiveSubgroupImage = "550.png"
        .AddAdaptiveSubgroupText(, , , , TextAlign_Center) = "36â„ƒ"
        .AddAdaptiveSubgroupText(TextStyle_CaptionSubtle, , , , TextAlign_Center) = "26â„ƒ"
        .AddAdaptiveSubgroup (1)

        '3subgroup
        .AddAdaptiveSubgroupText(, , , , TextAlign_Center) = "Wed"
        .AddAdaptiveSubgroupImage = "200.png"
        .AddAdaptiveSubgroupText(, , , , TextAlign_Center) = "26â„ƒ"
        .AddAdaptiveSubgroupText(TextStyle_CaptionSubtle, , , , TextAlign_Center) = "23â„ƒ"
        .AddAdaptiveSubgroup (1)

        '4subgroup
        .AddAdaptiveSubgroupText(, , , , TextAlign_Center) = "Thu"
        .AddAdaptiveSubgroupImage = "300.png"
        .AddAdaptiveSubgroupText(, , , , TextAlign_Center) = "25â„ƒ"
        .AddAdaptiveSubgroupText(TextStyle_CaptionSubtle, , , , TextAlign_Center) = "23â„ƒ"
        .AddAdaptiveSubgroup (1)

        '5subgroup
        .AddAdaptiveSubgroupText(, , , , TextAlign_Center) = "Fri"
        .AddAdaptiveSubgroupImage = "850.png"
        .AddAdaptiveSubgroupText(, , , , TextAlign_Center) = "24â„ƒ"
        .AddAdaptiveSubgroupText(TextStyle_CaptionSubtle, , , , TextAlign_Center) = "22â„ƒ"
        .AddAdaptiveSubgroup (1)

        '6subgroup
        .AddAdaptiveSubgroupText(, , , , TextAlign_Center) = "Sat"
        .AddAdaptiveSubgroupImage = "430.png"
        .AddAdaptiveSubgroupText(, , , , TextAlign_Center) = "20â„ƒ"
        .AddAdaptiveSubgroupText(TextStyle_CaptionSubtle, , , , TextAlign_Center) = "14â„ƒ"
        .AddAdaptiveSubgroup (1)

        '7subgroup
        .AddAdaptiveSubgroupText(, , , , TextAlign_Center) = "Sun"
        .AddAdaptiveSubgroupImage = "411.png"
        .AddAdaptiveSubgroupText(, , , , TextAlign_Center) = "21â„ƒ"
        .AddAdaptiveSubgroupText(TextStyle_CaptionSubtle, , , , TextAlign_Center) = "18â„ƒ"
        .AddAdaptiveSubgroup (1)



        'å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ã‚’æ ¼ç´
        ActionCmd = .GenerateCmd_ToastNotifierShow("å¤©æ°—äºˆå ±")

        'é€šçŸ¥è¡¨ç¤º
        .RunDll_ToastNotifierShow "sample033"
        'wsh.Run ActionCmd, 0, False
    End With
End Sub
```
![alt text](doc/Ex_Element-Subgroup.png)

## [headerè¦ç´ ](https://learn.microsoft.com/ja-jp/uwp/schemas/tiles/toastschema/element-header)
### SetToastHeader
ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ ã‚»ãƒ³ã‚¿ãƒ¼å†…ã§è¤‡æ•°ã®é€šçŸ¥ã‚’ã‚°ãƒ«ãƒ¼ãƒ—ã«ã¾ã¨ã‚ã‚‹ã‚«ã‚¹ã‚¿ãƒ  ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æŒ‡å®šã—ã¾ã™ã€‚<br>
ãªãŠã€Classãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®šç¾©ã™ã‚‹éš›(Class_Initialize)ã€äºˆã‚æ—¢å®šå€¤ã‚’å…¥ã‚Œã‚‹ã‚ˆã†ã«ä»•è¾¼ã‚“ã§ã„ã‚‹ãŸã‚åŸºæœ¬ã€å‘¼ã³å‡ºã™å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

#### è¨­å®šå€¤
ä»»æ„ã®æ–‡å­—åˆ—<br>
æ—¢å®šå€¤ã¯ã€ThisWorkbook.Nameã§ã™ãŒã€æ‹¡å¼µå­ãŒã‚ã‚‹å ´åˆã¯ã€çœç•¥ã—ã¾ã™ã€‚

#### åˆ©ç”¨å¯èƒ½ãªå¼•æ•°
| å¼•æ•°å            | èª¬æ˜                                                                                                                           | æ—¢å®šå€¤            | 
| ----------------- | ------------------------------------------------------------------------------------------------------------------------------ | ----------------- | 
| ArgID             | ã“ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ä¸€æ„ã«è­˜åˆ¥ã—ã¾ã™ã€‚ 2 ã¤ã®é€šçŸ¥ãŒåŒã˜ãƒ˜ãƒƒãƒ€ãƒ¼ ID ã‚’æŒã¤å ´åˆã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ ã‚»ãƒ³ã‚¿ãƒ¼ã§åŒã˜ãƒ˜ãƒƒãƒ€ãƒ¼ã®ä¸‹ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ | ThisWorkbook.Name | 
| ArgArguments      | ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã“ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã‚¢ãƒ—ãƒªã«è¿”ã•ã‚Œã¾ã™ã€‚ null ã«ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚                                       | ThisWorkbook.Path | 
| ArgActivationType | ã“ã®ãƒ˜ãƒƒãƒ€ãƒ¼ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸå ´åˆã«ä½¿ç”¨ã™ã‚‹ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ã®ç¨®é¡ã€‚                                                                 | protocol          | 

> [!TIP]
> ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚»ãƒ³ã‚¿ãƒ¼ã®ãƒ˜ãƒƒãƒ€ãƒ¼éƒ¨åˆ†ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã“ã®Excelãƒ–ãƒƒã‚¯ã®ã‚ã‚‹ã‚«ãƒ¬ãƒ³ãƒˆãƒ‘ã‚¹ã‚’ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼ã§é–‹ãã“ã¨ãŒå¯èƒ½ã§ã™

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
```bas
Sub ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ†ã‚¹ãƒˆ()
    Dim AppNotification As New clsAppNotificationBuilder
    Dim ActionCmd As String

    With AppNotification
        'ãƒ˜ãƒƒãƒ€ãƒ¼åã‚’å¤‰æ›´
        .SetToastHeader = "ãˆãã›ã‚‹"



        'ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ã‚’ç”Ÿæˆ(Windows PowerShellçµŒç”±ã§å®Ÿè¡Œã™ã‚‹å ´åˆ)
        ActionCmd = .GenerateCmd_ToastNotifierShow("sample")

        'é€šçŸ¥è¡¨ç¤º
        'Shell ActionCmd, vbHide
        .RunDll_ToastNotifierShow "sample"
    End With
End Sub
```
![alt text](doc/Ex_Element-header.png)<br>

> [!TIP]
> ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ã‚¯ãƒªã‚¢ã—ãŸã„å ´åˆã¯ä¸‹è¨˜ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚<br>
> ã“ã‚Œã«ã‚ˆã‚Šã€Headerè¦ç´ è‡ªä½“ã‚’ãªãã—ã¾ã™ã€‚
> ```bas
> With New clsAppNotificationBuilder
>     .SetToastHeader = ""
> End With
>```

## [inputè¦ç´ ](https://learn.microsoft.com/ja-jp/uwp/schemas/tiles/toastschema/element-input)

### SetIToastInput

ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã«è¡¨ç¤ºã•ã‚Œã‚‹å…¥åŠ› (ãƒ†ã‚­ã‚¹ãƒˆ ãƒœãƒƒã‚¯ã‚¹ã¾ãŸã¯é¸æŠãƒ¡ãƒ‹ãƒ¥ãƒ¼) ã‚’æŒ‡å®šã—ã¾ã™ã€‚<br>

#### è¨­å®šå€¤
Inputè¦ç´ ã®é…ç½®é †ã€‚1~5ã¾ã§æœ‰åŠ¹ã§ã™ã€‚

#### åˆ©ç”¨å¯èƒ½ãªå¼•æ•°
| å¼•æ•°å                | èª¬æ˜                                                                    | æ—¢å®šå€¤       | 
| --------------------- | ----------------------------------------------------------------------- | ------------ | 
| ArgID                 | å…¥åŠ›ã«é–¢é€£ä»˜ã‘ã‚‰ã‚Œã¦ã„ã‚‹ ID                                             | â€»å¿…é ˆé …ç›®     | 
| ChoseFlag             | `True` "selection"<br>`False` "text"                                  | False        | 
| ArgPlaceHolderContent | ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ç”¨ã«è¡¨ç¤ºã•ã‚Œã‚‹ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã€‚<br>ChoseFlag=Falseæ™‚ã€æœ‰åŠ¹ | vbnullstring | 
| ArgTitle              | å…¥åŠ›ã®ãƒ©ãƒ™ãƒ«ã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã‚‹ãƒ†ã‚­ã‚¹ãƒˆ                                    | vbnullstring | 
| ArgDefaultInput       | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®å…¥åŠ›å€¤                                                      | vbnullstring | 

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
```bas
Sub ãƒ¡ãƒƒã‚»()
    Dim AppNotification As New clsAppNotificationBuilder
    Dim ActionCmd As String
    
    With AppNotification
        'ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›è¦ç´ ã‚’ä½œæˆ("ã¯ã¿ãŒããªã†ï¼"ã‚’é™¤å»ã™ã‚‹ã¨ã€å³ã®ã‚ˆã†ãªç”»åƒã«ãªã‚Šã¾ã™)
        .SetIToastInput("textBox", , "reply", "ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ãŒã§ãã¾ã™ã€‚", "ã¯ã¿ãŒããªã†ï¼") = 1



        'Inputã®IDã¨ã€Actionã®hint-inputIdã‚’åŒã˜å€¤ã«ã—ã¦ã€åŒã˜Indexå€¤ã«å¯¾å¿œã™ã‚‹Inputè¦ç´ ã®æ¨ªã«ãƒœã‚¿ãƒ³ã‚’é…ç½®ã§ãã¾ã™
        .SetIToastActions("Send", "", , , , , "textBox") = 1

        'ãƒãƒƒãƒˆä¸Šã®ç”»åƒã‚’ä½¿ç”¨ã™ã‚‹
        .AllowUse_InternetImage = True
        .SetToastGenericAppLogo(True) = "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhkdhNl7CCgOAZmjObZRRINCu9udW_Mum-_FSCEvLFULZRP_wEuO_Y1grKy28zSCw2fyBN5jM2RS1PYmE9prAk5uSI8ImDn1wcyZPy8ctGJ-vFaY36ULy_rjvrilHjXjuN0_O-p6sQi3Hc3/s857/ha_hamigaki_suit_woman.png"
        .SetToastGenericHeroImage = "https://unsplash.it/360/180?image=1043"

        .SetToastGenericTitleText = "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¿”ä¿¡ãƒ‡ã‚¶ã‚¤ãƒ³"

        'ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ã‚’ç”Ÿæˆ(Windows PowerShellçµŒç”±ã§å®Ÿè¡Œã™ã‚‹å ´åˆ)
        ActionCmd = .GenerateCmd_ToastNotifierShow("sample")

        'é€šçŸ¥è¡¨ç¤º
        'Shell ActionCmd, vbHide
        .RunDll_ToastNotifierShow "sample"
    End With
End Sub
```
![alt text](doc/Ex_Element-Input1-1.png) ![alt text](doc/Ex_Element-Input1-2.png)<br>


## [selectionè¦ç´ ](https://learn.microsoft.com/ja-jp/uwp/schemas/tiles/toastschema/element-selection)
### SetToastSelectionBox
é¸æŠé …ç›®ã® id ã¨ãƒ†ã‚­ã‚¹ãƒˆã‚’æŒ‡å®šã—ã¾ã™ã€‚å…¨ã¦å¿…é ˆé …ç›®ã§ã™ã€‚
åŸºæœ¬ã€ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ç”¨é€”ã®ã¿ã¨ãªã‚Šã¾ã™ã€‚

#### è¨­å®šå€¤
selectionè¦ç´ ã®é…ç½®é †ã€‚1~5ã¾ã§æœ‰åŠ¹ã§ã™ã€‚

#### åˆ©ç”¨å¯èƒ½ãªå¼•æ•°
| å¼•æ•°å         | èª¬æ˜                                               | å‚™è€ƒ                       | 
| -------------- | -------------------------------------------------- | -------------------------- | 
| ReminderMinute | ä½•åˆ†å¾Œã«ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼é€šçŸ¥ã•ã›ã‚‹ã‹ã€å€¤ã§æŒ‡å®šã—ã¾ã™ã€‚ | vbnullstringã§æœªå®šç¾©æ‰±ã„ã¨ã—ã¾ã™ã€‚ | 
| ArgChoseName   | é¸æŠé …ç›®ã®å†…å®¹                                     |                            | 

#### [ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã®è¨­å®šæ–¹æ³•](https://learn.microsoft.com/ja-jp/windows/apps/design/shell/tiles-and-notifications/adaptive-interactive-toasts?tabs=xml#snoozedismiss)
Inputè¦ç´ ã¨ã€selectionè¦ç´ ã‚’ä½¿ã£ãŸãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚<br>
ã‚³ãƒ¼ãƒ‰å†…ã‚³ãƒ¡ãƒ³ãƒˆã«ã‚ã‚‹æ‰‹é †ã‚’å‚è€ƒã«ã©ã†ãã€‚

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
```bas
Sub ãƒªãƒã‚¤ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ()
    Dim AppNotification As New clsAppNotificationBuilder
    Dim ActionCmd As String
    
    With AppNotification
        '1. ãƒˆãƒ¼ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ªã‚’ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã‹ã€ã‚¢ãƒ©ãƒ¼ãƒ ã«ã™ã‚‹
        .SetToastContent_Scenario = tsReminder

        '2. ç´ä»˜ã‘ç”¨è­˜åˆ¥å­ã‚’è¨­å®š
        Const ReminderID As String = "ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼"

        '3. selectè¦ç´ ã‚’æº–å‚™ã—ã€ãƒªãƒã‚¤ãƒ³ãƒ‰ã™ã‚‹"åˆ†"ã¨åç§°ã‚’ã‚»ãƒƒãƒˆ(æœ€å¤§ã€5ã¤)
        .SetToastSelectionBox(1, "1 åˆ†å¾Œ") = 1
        .SetToastSelectionBox(5, "5 åˆ†å¾Œ") = 2
        .SetToastSelectionBox(10, "10 åˆ†å¾Œ") = 3
        .SetToastSelectionBox(30, "30 åˆ†å¾Œ") = 4
        .SetToastSelectionBox(60, "1 æ™‚é–“å¾Œ") = 5

        '4. inputè¦ç´ ã‚’ä½œæˆã—ã€ä¸Šè¨˜ã§æº–å‚™ã—ãŸselectè¦ç´ ã‚’æŒ¿å…¥ã—ã€å…ˆã»ã©ä½œæˆã—ãŸç´ä»˜ã‘ç”¨è­˜åˆ¥å­ã‚’Input-IDã«ã‚»ãƒƒãƒˆ
        .SetIToastInput(ReminderID, True, , "é¸æŠè‚¢ã‹ã‚‰ã€ãƒªãƒã‚¤ãƒ³ãƒ‰ã™ã‚‹æ™‚é–“ã‚’é¸æŠ", 10) = 1

        '5. å†é€šçŸ¥ç”¨ã¨ã€è§£é™¤ç”¨ã‚’ç”¨æ„("snooze", taSystem,ReminderID ã«ã‚»ãƒƒãƒˆã•ã‚Œã¦ã‚‹å¼•æ•°ä½ç½®ã¯ã€å¿…ãšã“ã®å€¤ã«ã™ã‚‹)
        .SetIToastActions("", "snooze", taSystem, , , , ReminderID) = 1
        .SetIToastActions("", "dismiss", taSystem) = 2

        '6. ãƒ†ã‚­ã‚¹ãƒˆè¦ç´ ã‚’ç”¨æ„(ä»»æ„)
        .SetToastGenericTitleText = "ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ãƒ†ã‚¹ãƒˆ"
        .SetToastGenericContentsText = "ã€Œå†é€šçŸ¥ã€ã§ã€é¸æŠã—ãŸæ™‚é–“ã§ã€å†é€šçŸ¥" & vbcrlf & "è§£é™¤ã§ã€ä½•ã‚‚ã—ãªã„"

        '7. ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ã‚’ç”Ÿæˆ(Windows PowerShellçµŒç”±ã§å®Ÿè¡Œã™ã‚‹å ´åˆ)
        ActionCmd = .GenerateCmd_ToastNotifierShow("ãƒªãƒã‚¤ãƒ³ãƒ‰")

        '8. é€šçŸ¥è¡¨ç¤º
        .RunDll_ToastNotifierShow "ãƒªãƒã‚¤ãƒ³ãƒ‰"
        'Shell ActionCmd,vbHide
    End With
End Sub
```
![alt text](doc/Ex_Element-Selection1-1.png) ![alt text](doc/Ex_Element-Selection1-2.png)

## ãã®ä»–
### SetTimeZone
ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã‚’å¤‰æ›´ã—ã¾ã™ã€‚<br>
å¾Œè¿°ã®ã€é€šçŸ¥ã®æœ‰åŠ¹æœŸé™ã€é€šçŸ¥ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãªã©ã®æ—¥ä»˜é–¢ä¿‚ã®å‡¦ç†ã‚’è¡Œã†éš›ã€UTCåŸºæº–ã«ãªã‚‹ãŸã‚ã€ãã®ã‚ºãƒ¬ã‚’è£œæ­£ã—ã¾ã™ã€‚<br>
ãªãŠã€Classãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®šç¾©ã™ã‚‹éš›(Class_Initialize)ã€äºˆã‚æ—¥æœ¬æ™‚é–“ã¨ã—ã¦ã‚»ãƒƒãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹ãŸã‚ã€æ—¥æœ¬åœ¨å®…è€…ã¯å‘¼ã³å‡ºã™å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<br>
å›½ã‚’ã¾ãŸãŒãªã„ä½¿ç”¨ã®å ´åˆã¯ã€Class_Initialize ã®æ‰€ã§ã€äºˆã‚è‡ªå›½ã¨ã—ã¦è¨­å®šã—ç›´ã™ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

#### åˆ©ç”¨å¯èƒ½ãªå¼•æ•°
| å¼•æ•°å        | èª¬æ˜                                                          | 
| ------------- | ------------------------------------------------------------- | 
| ArgUTC_Hour   | UTCã‹ã‚‰ã®æ™‚å·®ã®ã†ã¡ã€æ™‚ã®éƒ¨åˆ†ã‚’æŒ‡å®šã—ã¾ã™ã€‚<br>æ­£è² å¯¾å¿œã§ã™ã€‚ | 
| ArgUTC_Minute | UTCã‹ã‚‰ã®æ™‚å·®ã®ã†ã¡ã€åˆ†ã®éƒ¨åˆ†ã‚’æŒ‡å®šã—ã¾ã™ã€‚                   | 

æ—¥æœ¬ã®å ´åˆã€ã€ŒJST / UTC+0900ã€ãªã®ã§ã€ä¸Šè¨˜ã«å½“ã¦ã¯ã‚ã‚‹ã¨ã€ä¸‹è¨˜ã«ãªã‚Šã¾ã™
```bas
    SetTimeZone 9, 0
```

ç±³å›½æ±éƒ¨ã®å ´åˆã€ã€ŒEST / UTC-0500ã€ãªã®ã§ã€ä¸‹è¨˜ã«ãªã‚Šã¾ã™ã€‚
```bas
    SetTimeZone -5, 0
```

ã‚¤ãƒ³ãƒ‰ã®å ´åˆã€ã€ŒIST / UTC+0530ã€ãªã®ã§ã€ä¸‹è¨˜ã«ãªã‚Šã¾ã™ã€‚
```bas
    SetTimeZone 5, 30
```

### PresetReminder
ã“ã®1è¡Œã‚’è¨˜è¿°ã™ã‚‹ã“ã¨ã§ã€ç°¡å˜ã«ãƒªãƒã‚¤ãƒ³ãƒ‰æ©Ÿèƒ½ã‚’ä½œæˆã§ãã¾ã™ã€‚<br>
ã“ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å‘¼ã³å‡ºã™å‰ã«å®šç¾©ã—ãŸä¸‹è¨˜ã®è¦ç´ ã¯ã€ä¸Šæ›¸ãã•ã‚Œã¾ã™ã®ã§ã”æ³¨æ„ãã ã•ã„ã€‚
- 1,2ã¤ç›®ã®actionè¦ç´ 
- 1ã¤ç›®ã®inputè¦ç´ 

#### åˆ©ç”¨å¯èƒ½ãªå¼•æ•°
| å¼•æ•°å          | èª¬æ˜                                                                     | 
| --------------- | ------------------------------------------------------------------------ | 
| RemindMinute1~5 | ä½•åˆ†å¾Œã«å†é€šçŸ¥ã™ã‚‹ã‹æ•°å€¤ã§æŒ‡å®šã€‚æœ€å¤§5ã¤åˆ†<br>1ã¤ç›®ã®ã¿å¿…é ˆã€‚ä»–ã¯çœç•¥å¯ã€‚ | 
| Message         | å…¥åŠ›ã®ãƒ©ãƒ™ãƒ«ã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã‚‹ãƒ†ã‚­ã‚¹ãƒˆã€‚                                   | 

> [!CAUTION]
> åˆ¶é™äº‹é …ã¨ã—ã¦ã€é¸æŠè‚¢ã®è¡¨è¨˜ã¯å…¨ã¦`åˆ†`ã§ã™ã€‚

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
```bas
Sub ç°¡æ˜“ãƒªãƒã‚¤ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ()
    Dim AppNotification As New clsAppNotificationBuilder
    Dim ActionCmd As String
    
    With AppNotification
        'è¨˜è¿°
        .PresetReminder 1, 5, 10, 30, 120, "é¸æŠè‚¢ã‹ã‚‰ï½¤ãƒªãƒã‚¤ãƒ³ãƒ‰ã™ã‚‹æ™‚é–“ã‚’é¸æŠ"



        'ãƒ†ã‚­ã‚¹ãƒˆè¦ç´ ã‚’ç”¨æ„(ä»»æ„)
        .SetToastGenericTitleText = "ç°¡æ˜“ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ãƒ†ã‚¹ãƒˆ"
        .SetToastGenericContentsText = "ã€Œå†é€šçŸ¥ã€ã§ã€é¸æŠã—ãŸæ™‚é–“ã§ã€å†é€šçŸ¥" & vbCrLf & "è§£é™¤ã§ã€ä½•ã‚‚ã—ãªã„"

        'ãƒªãƒã‚¤ãƒ³ãƒ‰ãƒ¢ãƒ¼ãƒ‰
        .SetToastContent_Scenario = tsReminder

        'ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ã‚’ç”Ÿæˆ(Windows PowerShellçµŒç”±ã§å®Ÿè¡Œã™ã‚‹å ´åˆ)
        ActionCmd = .GenerateCmd_ToastNotifierShow("ç°¡æ˜“ãƒªãƒã‚¤ãƒ³ãƒ‰")

        'é€šçŸ¥è¡¨ç¤º
        .RunDll_ToastNotifierShow "ç°¡æ˜“ãƒªãƒã‚¤ãƒ³ãƒ‰"
        'Shell ActionCmd,vbHide
    End With
End Sub
```
![alt text](doc/PresetReminder1-1.png) ![alt text](doc/PresetReminder1-2.png)


# ãƒ¡ã‚½ãƒƒãƒ‰èª¬æ˜
## å˜ç´”ãªé€šçŸ¥
### GenerateCmd_ToastNotifierShow
å¼•æ•°ã«æ¸¡ã•ã‚ŒãŸå€¤ã§ã€å˜ç´”ãªãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’è¡¨ç¤ºã™ã‚‹ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ã‚’è¿”ã—ã¾ã™ã€‚æŒ‡å®šæ—¥æ™‚ã«é€šçŸ¥ã™ã‚‹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æ©Ÿèƒ½ã‚‚å¯¾å¿œã—ã¾ã™<br>
ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ã‚’è¿”ã™ãŸã‚ã€Shellé–¢æ•°ã¨ä½µç”¨ã—ã¦ä½¿ç”¨ã—ã¦ä¸‹ã•ã„ã€‚Windows PowerShellç’°å¢ƒãŒã‚ã‚Œã°ã€Windows 10 ä»¥é™ã®ã©ã®PCã§ã‚‚å‹•ä½œãŒå¯èƒ½ã§ã™ã€‚

#### åˆ©ç”¨å¯èƒ½ãªå¼•æ•°
| å¼•æ•°                                                                                                                                                         | æ„å‘³                                                                                 | å‹         | æ—¢å®šå€¤       | 
| ------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------ | ---------- | ------------ | 
| [ToastTag](https://learn.microsoft.com/ja-jp/uwp/api/windows.ui.notifications.toastnotification.tag)                                                         | ã‚°ãƒ«ãƒ¼ãƒ—å†…ã®ã“ã®é€šçŸ¥ã®ä¸€æ„è­˜åˆ¥å­ã‚’è¨­å®šã—ã¾ã™ã€‚                        | æ–‡å­—åˆ—     | â€»å¿…é ˆé …ç›®   | 
| [CollectionID](https://learn.microsoft.com/ja-jp/uwp/api/windows.ui.notifications.toastnotificationmanagerforuser.gettoastnotifierfortoastcollectionidasync) | é€ä¿¡ã™ã‚‹é€šçŸ¥ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã®IDã€‚                                                          | æ–‡å­—åˆ—     | vbnullstring | 
| [ScheduleDate](https://learn.microsoft.com/ja-jp/uwp/api/windows.ui.notifications.scheduledtoastnotification.-ctor)                                          | Windows ã§ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’è¡¨ç¤ºã™ã‚‹æ—¥ä»˜ã¨æ™‚åˆ»ã€‚<br>è¨­å®šæ—¥æ™‚ã«ãªã‚‹ã¾ã§ã€ãƒˆãƒ¼ã‚¹ãƒˆã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚<br><br>ãƒ»éå»ã«ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚<br>ãƒ»çœç•¥(0) ã§ã€å³æ—¥é€šçŸ¥ã§ã™ã€‚                        | ã‚·ãƒªã‚¢ãƒ«å€¤ | 0            | 
| [ExpirationDate](https://learn.microsoft.com/ja-jp/uwp/api/windows.ui.notifications.scheduledtoastnotification.expirationtime)                               | é€šçŸ¥ã®æœ‰åŠ¹æœŸé™ã€‚<br>è¨­å®šæ—¥æ™‚ã‚’è¶…ãˆã‚‹ã¨ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚»ãƒ³ã‚¿ãƒ¼ã‹ã‚‰å‰Šé™¤ã•ã‚Œã¾ã™ã€‚<br><br>ãƒ»éå»ã«ã™ã‚‹ã¨ã€é€šçŸ¥ãŒæ¥ã¾ã›ã‚“ã€‚<br>ãƒ»çœç•¥(0) ã§ã€3æ—¥å¾Œã®æœ‰åŠ¹æœŸé™ã«ãªã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã‚·ã‚¹ãƒ†ãƒ ã§æ±ºã‚ã‚‰ã‚ŒãŸ[ä¸Šé™](https://learn.microsoft.com/ja-jp/windows/apps/design/shell/tiles-and-notifications/send-local-toast-cpp-uwp?tabs=builder-syntax#set-an-expiration-time)ã§ã™ã€‚<br>ãƒ»è² ã«è¨­å®šã™ã‚‹ã¨ã€[å†èµ·å‹•æ™‚ã€é€šçŸ¥ãŒæ¶ˆãˆã‚‹](https://learn.microsoft.com/ja-jp/uwp/api/windows.ui.notifications.toastnotification.expiresonreboot)ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚                                                                     | ã‚·ãƒªã‚¢ãƒ«å€¤ | 0            | 
| [Suppress](https://learn.microsoft.com/ja-jp/uwp/api/windows.ui.notifications.toastnotification.suppresspopup)                                               | ãƒˆãƒ¼ã‚¹ãƒˆã®ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— UI ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç”»é¢ã«è¡¨ç¤ºã™ã‚‹ã‹ã©ã†ã‹ã‚’å–å¾—ã¾ãŸã¯è¨­å®šã—ã¾ã™ã€‚ | ãƒ•ãƒ©ã‚°å€¤   | False        | 

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
æ¬¡ã®ä¾‹ã§ã¯ã€10ç§’å¾Œã«é€šçŸ¥ãŒæ¥ã¾ã™ã€‚
```bas
Sub ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’è¨­å®š()
    Dim AppNotification As New clsAppNotificationBuilder
    Dim ActionCmd As String

    With AppNotification
        'ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹ã‚’è¨­å®š
        .SetToastGenericTitleText = "Hello World"
        .SetToastGenericContentsText = "10ç§’å¾Œã«é€šçŸ¥ã—ã¾ã—ãŸã€‚"
        .SetToastGenericAttributionText = "ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚·ã‚¹ãƒ†ãƒ  Shell"

        'ç¾åœ¨ã‹ã‚‰ã€10så¾Œã«é€šçŸ¥ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ã‚’ç”Ÿæˆ
        ActionCmd = .GenerateCmd_ToastNotifierShow("sample", , Now() + #12:00:10 AM#)

        'å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ç¢ºèª
        Debug.Print ActionCmd
        Stop

        'é€šçŸ¥è¡¨ç¤ºã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ
        Shell ActionCmd, vbHide
    End With
End Sub
```
10ç§’çµŒã¤ã¨ã€ã“ã®é€šçŸ¥ãŒã§ãã¾ã™<br>
![alt text](doc/ExampleMethod1.png)

#### è¿”ã‚Šå€¤
ã“ã®ã‚ˆã†ãªã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ãŒã€è¿”ã‚Šã¾ã™ã€‚<br>
ã“ã‚Œã‚’Shellã«ä»‹ã™ã“ã¨ã§ã€é€šçŸ¥è¡¨ç¤ºå‡ºæ¥ã¾ã™ã€‚ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ãªã‚‰ã€Stopéƒ¨åˆ†ã§ç¢ºèªå¯èƒ½ã§ã™ã€‚
```bat
powershell -Command "$xml = '<toast><visual><binding template=\"ToastGeneric\"><text>Hello World</text><text>10ç§’å¾Œã«é€šçŸ¥ã—ã¾ã—ãŸã€‚</text><text placement=\"attribution\">ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚·ã‚¹ãƒ†ãƒ </text></binding></visual><header id=\"Book1\" title=\"Book1\" arguments=\"\" activationType=\"protocol\"/></toast>';$XmlDocument = [Windows.Data.Xml.Dom.XmlDocument, Windows.Data.Xml.Dom.XmlDocument, ContentType = WindowsRuntime]::New();$XmlDocument.loadXml($xml);$ToastNotification = [Windows.UI.Notifications.ScheduledToastNotification, Windows.UI.Notifications, ContentType = WindowsRuntime]::New($XmlDocument,'2024/09/21 11:27:02');$ToastNotification.id = 'ExcelSchedule';$ToastNotification.Group = 'Book1';$ToastNotification.Tag = 'sample';$AppId = 'Microsoft.Office.EXCEL.EXE.15';[Windows.UI.Notifications.ToastNotificationManager, Windows.UI.Notifications, ContentType = WindowsRuntime]::CreateToastNotifier($AppId).addToSchedule($ToastNotification)"
```

æ•´å½¢ã™ã‚‹ã¨ã“ã‚“ãªæ„Ÿã˜ã§ã™ã€‚
```ps1
powershell -Command "
$xml = '<toast><visual><binding template=\"ToastGeneric\"><text>Hello World</text><text>10ç§’å¾Œã«é€šçŸ¥ã—ã¾ã—ãŸã€‚</text><text placement=\"attribution\">ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚·ã‚¹ãƒ†ãƒ </text></binding></visual><header id=\"Book1\" title=\"Book1\" arguments=\"\" activationType=\"protocol\"/></toast>';
$XmlDocument = [Windows.Data.Xml.Dom.XmlDocument, Windows.Data.Xml.Dom.XmlDocument, ContentType = WindowsRuntime]::New();
$XmlDocument.loadXml($xml);
$ToastNotification = [Windows.UI.Notifications.ScheduledToastNotification, Windows.UI.Notifications, ContentType = WindowsRuntime]::New($XmlDocument,'2024/09/21 11:27:02');
$ToastNotification.id = 'ExcelSchedule';
$ToastNotification.Group = 'Book1';
$ToastNotification.Tag = 'sample';
$AppId = 'Microsoft.Office.EXCEL.EXE.15';
[Windows.UI.Notifications.ToastNotificationManager, Windows.UI.Notifications, ContentType = WindowsRuntime]::CreateToastNotifier($AppId).addToSchedule($ToastNotification)
"
```


### RunDll_ToastNotifierShow
GenerateCmd_ToastNotifierShow ã¨åŒæ§˜ã®æ©Ÿèƒ½ã§ã™ã€‚
ã“ã¡ã‚‰ã¯ã€DLLãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã ã¨ãã«ä½¿ã†å°‚ç”¨ãƒ¡ã‚½ãƒƒãƒ‰ã§ã™ã€‚Shellã‚’ä»‹ã•ãªã„åˆ†ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒå‘ä¸Šã™ã‚‹ã®ã§ä½¿ãˆã‚‹ç’°å¢ƒã§ã‚ã‚Œã°ã“ã¡ã‚‰ãŒãŠã™ã™ã‚ã§ã™ã€‚<br>
å¼•æ•°ç­‰ã¯ã€GenerateCmd_ToastNotifierShow ã¨åŒã˜ãªã®ã§çœç•¥ã—ã¾ã™ã€‚

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
æ¬¡ã®ä¾‹ã§ã‚‚ã€10ç§’å¾Œã«é€šçŸ¥ãŒæ¥ã¾ã™ã€‚
```bas
Sub ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’è¨­å®š()
    Dim AppNotification As New clsAppNotificationBuilder
    Dim ActionCmd As String

    With AppNotification
        'ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹ã‚’è¨­å®š
        .SetToastGenericTitleText = "Hello World"
        .SetToastGenericContentsText = "10ç§’å¾Œã«é€šçŸ¥ã—ã¾ã—ãŸã€‚"
        .SetToastGenericAttributionText = "ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚·ã‚¹ãƒ†ãƒ  DLL"


        'ç¾åœ¨ã‹ã‚‰ã€10så¾Œã«é€šçŸ¥ã™ã‚‹
        .RunDll_ToastNotifierShow "sample", , Now() + #12:00:10 AM#
    End With
End Sub
```


### GenerateCmd_ToastNotificationHistoryRemove
ã‚¿ã‚°ã‚’æŒ‡å®šã—ã¦ã€ãƒˆãƒ¼ã‚¹ãƒˆã®å‰Šé™¤ã‚’è¡Œã„ã¾ã™ã€‚<br>
ä¸»ã«ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ä»˜ãé€šçŸ¥ã«ãŠã„ã¦ã€å‡¦ç†ã®é€”ä¸­ã§ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã£ã¦å†é–‹ä¸å¯èƒ½ã®æ™‚ã€ä¸è‡ªç„¶ã«é€šçŸ¥ãŒæ®‹ã£ã¦ã‚‹ã¨ä¸æ°—å‘³ãªã®ã§ã€ã“ã‚Œã‚’å‘¼ã³å‡ºã—ã¦å‰Šé™¤ã—ã¦ã‚ã’ã¦ä¸‹ã•ã„ã€‚<br>
å› ã¿ã«ã€é€šçŸ¥éŸ³ãŒé³´ã£ã¦ã‚‹é€”ä¸­ã§å‰Šé™¤ã™ã‚‹ã¨ã€é€šçŸ¥éŸ³ã‚‚åœæ­¢ã—ã¾ã™ã€‚

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
æ¬¡ã®ä¾‹ã¯ã€é€šå¸¸é€šã‚Šé€šçŸ¥ã‚’å‘¼ã³å‡ºã—ã€MsgBoxã«åå¿œã™ã‚‹ã¨ã€é€šçŸ¥ãŒæ¶ˆãˆã¾ã™ã€‚
```bas
Sub ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥å‰Šé™¤()
    Const ToastTag As String = "deleteTest"

    With New clsAppNotificationBuilder
        'è¡¨ç¤ºãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¨­å®š
        .SetToastGenericTitleText = "Hello World"
        .SetToastGenericContentsText = "MsgBoxã«åå¿œã™ã‚‹ã¨ã€ã“ã®ãƒˆãƒ¼ã‚¹ãƒˆãŒæ¶ˆãˆã¾ã™"
        .SetToastGenericAttributionText = "å‰Šé™¤ãƒ†ã‚¹ãƒˆ"
        .SetToastContent_Scenario = tsIncomingCall

        'é€šçŸ¥è¡¨ç¤º
        Shell .GenerateCmd_ToastNotifierShow(ToastTag), vbHide
        
        'ç¶šã‘ã‚‹ã¨é€šçŸ¥ãŒæ¶ˆãˆã¾ã™
        MsgBox "OKã‚’æŠ¼ã™ã¨ã€é€šçŸ¥ã‚’å‰Šé™¤ã—ã¾ã™", vbInformation, "RemoveNotice"

        'å‰Šé™¤
        Shell .GenerateCmd_ToastNotificationHistoryRemove(ToastTag), vbHide

    End With
End Sub
```
#### è¿”ã‚Šå€¤
ã“ã®ã‚ˆã†ãªã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ãŒã€è¿”ã‚Šã¾ã™ã€‚1è¡Œå®Œçµã§ã™ã€‚<br>
ã“ã‚Œã‚’Shellã«ä»‹ã™ã“ã¨ã§ã€æŒ‡å®šã®ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’å‰Šé™¤ã§ãã¾ã™ã€‚
```bat
powershell -Command "[Windows.UI.Notifications.ToastNotificationManager, Windows.UI.Notifications, ContentType = WindowsRuntime]::History.Remove('deleteTest','Book1','Microsoft.Office.EXCEL.EXE.15')"
```

### RunDll_ToastNotificationHistoryRemove
GenerateCmd_ToastNotificationHistoryRemove ã¨åŒæ§˜ã®æ©Ÿèƒ½ã§ã™ã€‚
å…ˆè¿°ã¨åŒæ§˜ã“ã¡ã‚‰ã‚‚ã€DLLãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã ã¨ãã«ä½¿ã†å°‚ç”¨ãƒ¡ã‚½ãƒƒãƒ‰ã§ã™ã€‚Shellã‚’ä»‹ã•ãªã„åˆ†ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒå‘ä¸Šã™ã‚‹ã®ã§ä½¿ãˆã‚‹ç’°å¢ƒã§ã‚ã‚Œã°ã“ã¡ã‚‰ãŒãŠã™ã™ã‚ã§ã™ã€‚<br>
å¼•æ•°ç­‰ã¯ã€GenerateCmd_ToastNotificationHistoryRemove ã¨åŒã˜ãªã®ã§çœç•¥ã—ã¾ã™ã€‚

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
æ¬¡ã®ä¾‹ã‚‚ã€é€šå¸¸é€šã‚Šé€šçŸ¥ã‚’å‘¼ã³å‡ºã—ã€MsgBoxã«åå¿œã™ã‚‹ã¨ã€é€šçŸ¥ãŒæ¶ˆãˆã¾ã™ã€‚
```bas
Sub ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥å‰Šé™¤()
    Const ToastTag As String = "deleteTest"

    With New clsAppNotificationBuilder
        'è¡¨ç¤ºãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¨­å®š
        .SetToastGenericTitleText = "Hello World"
        .SetToastGenericContentsText = "MsgBoxã«åå¿œã™ã‚‹ã¨ã€ã“ã®ãƒˆãƒ¼ã‚¹ãƒˆãŒæ¶ˆãˆã¾ã™"
        .SetToastGenericAttributionText = "å‰Šé™¤ãƒ†ã‚¹ãƒˆ"
        .SetToastContent_Scenario = tsIncomingCall

        'é€šçŸ¥è¡¨ç¤º
        .RunDll_ToastNotifierShow ToastTag
        
        'ç¶šã‘ã‚‹ã¨é€šçŸ¥ãŒæ¶ˆãˆã¾ã™
        MsgBox "OKã‚’æŠ¼ã™ã¨ã€é€šçŸ¥ã‚’å‰Šé™¤ã—ã¾ã™", vbInformation, "RemoveNotice"

        'å‰Šé™¤
        .RunDll_ToastNotificationHistoryRemove ToastTag

    End With
End Sub
```

## [ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ä»˜ãé€šçŸ¥ã«ã¤ã„ã¦](https://learn.microsoft.com/ja-jp/windows/apps/design/shell/tiles-and-notifications/toast-progress-bar)

`SetAdaptiveProgressBar` ã¨ `ã€‡ã€‡_ToastNotifierShow` ã‚’çµ„ã¿åˆã‚ã›ã¦è¡¨ç¤ºã—ãŸå¾Œã€`ã€‡ã€‡_ToastNotifierUpdate` ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€é€šçŸ¥ã‚’è¡¨ç¤ºã—ãªãŒã‚‰æ›´æ–°å‡¦ç†ã‚’è¡Œã†ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚

### SetAdaptiveProgressBar

ã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã§ã€Progressè¦ç´ ã®å±æ€§å€¤ã‚’å¤‰æ›´/è¨­å®šã—ã¾ã™ã€‚

![alt text](doc/Ex_Element-Progress.png)

#### è¨­å®šå€¤
`Status` ã‚’è¨­å®šã—ã¾ã™ã€‚æ–‡å­—åˆ—ã§å¿…é ˆé …ç›®ã¨ãªã‚Šã¾ã™ã€‚

> [!TIP]
> Progressè¦ç´ ã‚’è¨­å®šã—è¡¨ç¤ºå¾Œã€å®Œäº†é€šçŸ¥ã¿ãŸã„ã«Progressè¦ç´ è‡ªä½“ã‚’ãªãã™ã«ã¯ã€`ã€‡ã€‡_ToastNotifierShow` ã‚’è¡Œã†æ‰‹å‰ã« `.SetAdaptiveProgressBar = vbNullString` ã¨è¨˜è¿°ã™ã‚‹ã“ã¨ã§ã€ãªãã™ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚

#### åˆ©ç”¨å¯èƒ½ãªå¼•æ•°
| å¼•æ•°å                  | èª¬æ˜                                                                                                                                                                               | æ—¢å®šå€¤       | 
| ----------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------ | 
| Arg_Value               | é€²è¡Œå€¤ã‚’è¨­å®šã—ã¾ã™ã€‚<br>åŸºæœ¬ã¯ã€0.0~1.0ã®Doubleã§æŒ‡å®šã§ã™ã€‚<br>ãŸã ã—ã€è² ã®å€¤ã«ã™ã‚‹ã¨ã€"Indeterminate" ã¨ãªã‚Šã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‰ãƒƒãƒˆã«ã‚ˆã‚‹ã€å‡¦ç†ä¸­ã‚’ç¤ºã™çŠ¶æ…‹ã«ãªã‚Šã¾ã™ã€‚| 0            | 
| Arg_Title               | ã‚¿ã‚¤ãƒˆãƒ«æ–‡å­—åˆ—ã‚’è¨­å®šã—ã¾ã™ã€‚                                                                                                                                                       | ç©ºæ–‡å­—       | 
| Arg_ValueStringOverride | å‰²åˆã‚’ç¤ºã™æ—¢å®šã®æ–‡å­—åˆ—ã«ä»£ã‚ã£ã¦è¡¨ç¤ºã•ã‚Œã‚‹æ–‡å­—åˆ— (ã‚ªãƒ—ã‚·ãƒ§ãƒ³) ã‚’è¨­å®šã—ã¾ã™ã€‚<br>ã“ã‚Œã‚’æŒ‡å®šã—ãªã„å ´åˆã¯ã€"70%" ã¨ã„ã†æ›¸å¼ã«ãªã‚Šã¾ã™ã€‚                                              | vbnullstring | 

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
æ¬¡ã®ä¾‹ã§ã¯ã€50%ã¨ã—ã¦ã€ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ä»˜ãé€šçŸ¥ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```bas
Sub ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã‚’è¡¨ç¤º()
    Dim AppNotification As New clsAppNotificationBuilder
    Dim ActionCmd As String

    With AppNotification
        'ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹ã‚’è¨­å®š
        .SetToastGenericTitleText = "ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ãƒ†ã‚¹ãƒˆ"

        'Progressè¦ç´ ã‚’æ§‹æˆ
        .SetAdaptiveProgressBar(0.5, "é€²æ—ãƒãƒ¼ãƒ†ã‚¹ãƒˆ") = "Processing..."

        'ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ä»˜ãé€šçŸ¥ã‚’è¡¨ç¤ºã™ã‚‹ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ã‚’ç”Ÿæˆ
        ActionCmd = .GenerateCmd_ToastNotifierShow("FirstProgressBar")

        'å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ç¢ºèª
        Debug.Print ActionCmd
        Stop

        'é€šçŸ¥è¡¨ç¤ºã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ
        Shell ActionCmd, vbHide
    End With
End Sub
```

![alt text](doc/ExampleMethod2.png)<br>
ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã®è‰²ã¯ã€Windowsã®ãƒ†ãƒ¼ãƒè‰²ã«åŸºã¥ãã¾ã™ã€‚å®¹æ˜“ã«è‰²ã‚’å¤‰ãˆã‚‹ã“ã¨ã¯å‡ºæ¥ã¾ã›ã‚“ã€‚

### GenerateCmd_ToastNotifierUpdate

ã“ã®çŠ¶æ…‹ã§ã¯ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã®æ„å‘³ã‚’ãªã•ãªã„ã®ã§ã€ä¸Šè¨˜ã®ãƒ¡ã‚½ãƒƒãƒ‰ã§ã€æ›´æ–°å‡¦ç†ã‚’è¡Œã„ã¾ã™ã€‚<br>
ã“ã‚Œã‚’å‘¼ã³å‡ºã™å‰ã«ã€`SetAdaptiveProgressBar` ã§å†åº¦å€¤ã‚’æ›´æ–°ã—ã¦å‘¼ã³å‡ºã™ã¨ã„ã„ã§ã—ã‚‡ã†ã€‚<br>
å¼•æ•°ã¯ã€`ToastID,CollectionID` ã§ã™ã€‚åŸºæœ¬ã¯ã€`ToastID`ã®ã¿ã§OKã§ã™ã€‚

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
æ¬¡ã®ä¾‹ã¯ã€ã€Œãƒ‡ãƒ¼ã‚¿æº–å‚™â†’å‡¦ç†â†’å®Œäº†ã€ã¨ã„ã†ä¸€é€£ã®æ¼”å‡ºå‡¦ç†ã‚’è¡Œã„ã¾ã™ã€‚æœ€åˆã«ãŠè¦‹ã›ã—ãŸ4ã¤ç›®ã®DEMOã¨ã»ã¼åŒã˜æ¼”å‡ºã«ãªã‚Šã¾ã™ã€‚

```bas
Sub UpdateProgressBar()
    With New clsAppNotificationBuilder
        'ãƒ˜ãƒƒãƒ€ãƒ¼æƒ…å ±ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹
        .SetToastHeader = ""

        'ã‚¿ã‚¤ãƒˆãƒ«è¨­å®š
        .SetToastGenericTitleText = "ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«åé›†"

        'å¸¸æ™‚è¡¨ç¤ºã™ã‚‹ãŸã‚ã€ã‚·ãƒŠãƒªã‚ªã‚’"IncomingCall"ã«ã™ã‚‹
        .SetToastContent_Scenario = tsIncomingCall

        '"Indeterminate"ã§ã€æº–å‚™ã£ã½ã„æ¼”å‡ºã‚’ã™ã‚‹
        Dim ToastTag As String
        ToastTag = "ProgressUpdate"
        
        .SetAdaptiveProgressBar(True) = "Ready..."
        
        Shell .GenerateCmd_ToastNotifierShow(ToastTag), vbHide

        '5så¾…æ©Ÿ
        Application.Wait (Now() + TimeValue("0:00:05"))



        'Updateã§ã€ä¸€éƒ¨åˆ†ã®å†…å®¹ã‚’ç½®ãæ›ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹
        Dim currentProgress As Long
        For currentProgress = 0 To 100
            DoEvents    'ãƒ•ãƒªãƒ¼ã‚ºå¯¾ç­–
            
            'ä½•ã‹ã®å‡¦ç†
            
            'ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼æ›´æ–°
            .SetAdaptiveProgressBar(currentProgress / 100, "ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã‚’æ›´æ–°") = "å‡¦ç†ä¸­..."
            Shell .GenerateCmd_ToastNotifierUpdate(ToastTag), vbHide

        Next



        'ãƒˆãƒ¼ã‚¹ãƒˆã®ã™ã¹ã¦ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„/ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’å®Œå…¨ã«å¤‰æ›´ã—ã€çµ‚äº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã—ã¦è¡¨ç¤º
        .SetToastContent_Scenario = Default     'ã‚·ãƒŠãƒªã‚ªã‚’é€šå¸¸ã«
        .SetAdaptiveProgressBar = ""            'Progressè¦ç´ ã‚’é™¤å¤–ã™ã‚‹
    
        .SetToastGenericContentsText = "ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã®æ›´æ–°å‡¦ç†ã‚’çµ‚ãˆã¾ã—ãŸ"
        Shell .GenerateCmd_ToastNotifierShow(ToastTag), vbHide
    End With
End Sub
```

å®Ÿè¡Œã™ã‚‹ã¨åˆ†ã‹ã‚Šã¾ã™ãŒã€ã‹ãªã‚ŠCPUã«è² è·ãŒã‹ã‹ã‚‹ãŸã‚ã€å®Ÿéš›ã«é‹ç”¨ã™ã‚‹éš›ã¯ã€ä¸€å®šãƒ«ãƒ¼ãƒ—æ¯ã«1åº¦ã®Updateå‡¦ç†ã‚’æµã™ã®ãŒæœ›ã¾ã—ã„ã§ã™ã€‚<br>
å®Ÿéš›ã€Application.StatusBar ã‚‚[æ¯å›å‘¼ã³å‡ºã™](https://qiita.com/OldCity/items/8b24d4c45da17165fa4e)ã¨ã€è² è·ãŒã‹ã‹ã‚Šã¾ã™ã€‚

### RunDll_ToastNotifierUpdate

`GenerateCmd_ToastNotifierUpdate` ã¨åŒæ§˜ã®æ©Ÿèƒ½ã§ã™ã€‚
å…ˆè¿°ã¨åŒæ§˜ã“ã¡ã‚‰ã‚‚ã€DLLãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã ã¨ãã«ä½¿ã†å°‚ç”¨ãƒ¡ã‚½ãƒƒãƒ‰ã§ã™ã€‚Shellã‚’ä»‹ã•ãªã„åˆ†ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒå‘ä¸Šã™ã‚‹ã®ã§ä½¿ãˆã‚‹ç’°å¢ƒã§ã‚ã‚Œã°ã“ã¡ã‚‰ãŒãŠã™ã™ã‚ã§ã™ã€‚<br>
å¼•æ•°ç­‰ã¯ã€GenerateCmd_ToastNotifierUpdate ã¨åŒã˜ãªã®ã§çœç•¥ã—ã¾ã™ã€‚

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
æ¬¡ã®ä¾‹ã‚‚ã€ã€Œãƒ‡ãƒ¼ã‚¿æº–å‚™â†’å‡¦ç†â†’å®Œäº†ã€ã¨ã„ã†ä¸€é€£ã®æ¼”å‡ºå‡¦ç†ã‚’è¡Œã„ã¾ã™ã€‚æœ€åˆã«ãŠè¦‹ã›ã—ãŸ4ã¤ç›®ã®DEMOã¨ã»ã¼åŒã˜æ¼”å‡ºã«ãªã‚Šã¾ã™ã€‚
```bas
Sub UpdateProgressBar()
    With New clsAppNotificationBuilder
        'ãƒ˜ãƒƒãƒ€ãƒ¼æƒ…å ±ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹
        .SetToastHeader = ""

        'ã‚¿ã‚¤ãƒˆãƒ«è¨­å®š
        .SetToastGenericTitleText = "ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«åé›†"

        'å¸¸æ™‚è¡¨ç¤ºã™ã‚‹ãŸã‚ã€ã‚·ãƒŠãƒªã‚ªã‚’"IncomingCall"ã«ã™ã‚‹
        .SetToastContent_Scenario = tsIncomingCall

        '"Indeterminate"ã§ã€æº–å‚™ã£ã½ã„æ¼”å‡ºã‚’ã™ã‚‹
        Dim ToastTag As String
        ToastTag = "ProgressUpdate"
        
        .SetAdaptiveProgressBar(True) = "Ready..."
        
        .RunDll_ToastNotifierShow ToastTag

        '5så¾…æ©Ÿ
        Application.Wait (Now() + TimeValue("0:00:05"))



        'Updateã§ã€ä¸€éƒ¨åˆ†ã®å†…å®¹ã‚’ç½®ãæ›ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹
        Dim currentProgress As Long
        For currentProgress = 0 To 100
            DoEvents    'ãƒ•ãƒªãƒ¼ã‚ºå¯¾ç­–
            
            'ä½•ã‹ã®å‡¦ç†
            
            'ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼æ›´æ–°
            .SetAdaptiveProgressBar(currentProgress / 100, "ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã‚’æ›´æ–°") = "å‡¦ç†ä¸­..."
            Debug.Print .RunDll_ToastNotifierUpdate(ToastTag)
            
            '1så¾…æ©Ÿ
            Application.Wait (Now() + TimeValue("0:00:01"))

        Next



        'ãƒˆãƒ¼ã‚¹ãƒˆã®ã™ã¹ã¦ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„/ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’å®Œå…¨ã«å¤‰æ›´ã—ã€çµ‚äº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã—ã¦è¡¨ç¤º
        .SetToastContent_Scenario = Default     'ã‚·ãƒŠãƒªã‚ªã‚’é€šå¸¸ã«
        .SetAdaptiveProgressBar = ""            'Progressè¦ç´ ã‚’é™¤å¤–ã™ã‚‹
    
        .SetToastGenericContentsText = "ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã®æ›´æ–°å‡¦ç†ã‚’çµ‚ãˆã¾ã—ãŸ"
        .RunDll_ToastNotifierShow ToastTag
    End With
End Sub
```

#### è¿”ã‚Šå€¤
| è¿”ã‚Šå€¤ | èª¬æ˜                                                          | 
| ------ | ------------------------------------------------------------ | 
| 0      | Succeeded<br>é€šçŸ¥ãŒæ›´æ–°ã•ã‚Œã¾ã—ãŸã€‚                          | 
| 1      | Failed<br>é€šçŸ¥ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸã€‚                         | 
| 2      | NotificationNotFound<br>æŒ‡å®šã—ãŸé€šçŸ¥ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ | 

`RunDll_ToastNotifierUpdate` ã®å ´åˆã€åˆ—æŒ™å‹[NotificationUpdateResult](https://learn.microsoft.com/ja-jp/uwp/api/windows.ui.notifications.notificationupdateresult) ã®è¿”å´ã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€å‰è¿°ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã«ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé€šçŸ¥ã‚’é–‰ã˜ãŸæ™‚ã€ãƒˆãƒ¼ã‚¹ãƒˆæ›´æ–°ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®é€ä¿¡ã‚’åœæ­¢ã—ã€ç„¡é§„ãªå‡¦ç†ã‚’ãªãã™ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚<br>
ç¾çŠ¶ã€ã€ŒGenerateCmd_ToastNotifierUpdateã€ã§ã¯ã€ä¸Šè¨˜ã®å¯¾å¿œã¯å‡ºæ¥ã¾ã›ã‚“ã€‚

## [ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ãŸãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã®ã‚°ãƒ«ãƒ¼ãƒ—åŒ–](https://learn.microsoft.com/ja-jp/windows/apps/design/shell/tiles-and-notifications/toast-collections)
è¡¨ç¤ºåã¨ã‚¢ã‚¤ã‚³ãƒ³ã‚’æŒ‡å®šã—ãŸheaderè¦ç´ ã‚ˆã‚Šã‚‚é«˜åº¦ãªã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã‚’æä¾›ã—ã¾ã™ã€‚<br>

> [!CAUTION]
> ä¸€å¿œã€PowerShellçµŒç”±ç‰ˆã‚‚ã‚ã‚Šã¾ã™ãŒã€å®‰å®šæ€§ã®è¦³ç‚¹ã‹ã‚‰DLLçµŒç”±ç‰ˆã®ãƒ¡ã‚½ãƒƒãƒ‰ã«ä½¿ç”¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚<br>
> ä»¥é™ã¯ã€DLLçµŒç”±ç‰ˆã®ã¿ã®èª¬æ˜ã¨ã—ã¾ã™ã€‚

### [RunDll_ToastCollectionManagerSaveToastCollectionAsync](https://learn.microsoft.com/ja-jp/uwp/api/windows.ui.notifications.toastcollectionmanager.savetoastcollectionasync)
æŒ‡å®šã—ãŸCollectionIDã§ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½œæˆã—ã¾ã™ã€‚

#### [åˆ©ç”¨å¯èƒ½ãªå¼•æ•°](https://learn.microsoft.com/ja-jp/uwp/api/windows.ui.notifications.toastcollection.-ctor?view=winrt-26100#windows-ui-notifications-toastcollection-ctor(system-string-system-string-system-string-windows-foundation-uri))
| å¼•æ•°å       | èª¬æ˜                                                                                                             | 
| ------------ | ---------------------------------------------------------------------------------------------------------------- | 
| CollectionId | ã“ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³é€šçŸ¥ã® ID ã‚’è¨­å®šã—ã¾ã™ã€‚                                                                         | 
| DisplayName  | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ ã‚»ãƒ³ã‚¿ãƒ¼ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚°ãƒ«ãƒ¼ãƒ— ã‚¿ã‚¤ãƒˆãƒ«ã‚’è¨­å®šã—ã¾ã™                                                     | 
| LaunchArgs   | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ ã‚»ãƒ³ã‚¿ãƒ¼ã§é€šçŸ¥ã‚°ãƒ«ãƒ¼ãƒ—ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã¨ãã«ã‚¢ãƒ—ãƒªã«æä¾›ã•ã‚Œã‚‹èµ·å‹•å¼•æ•°ã‚’è¨­å®šã—ã¾ã™ã€‚          | 
| IconUri      | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ ã‚»ãƒ³ã‚¿ãƒ¼ã®ã‚°ãƒ«ãƒ¼ãƒ— ã‚¿ã‚¤ãƒˆãƒ«ã®æ¨ªã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚¢ã‚¤ã‚³ãƒ³ã‚’è¨­å®šã—ã¾ã™ã€‚<br>ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ã‚¹ã®ã¿å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚ | 

#### è¿”ã‚Šå€¤
ä½œæˆã«æˆåŠŸã™ã‚‹ã¨ã€0 ã‚’è¿”ã—ã¾ã™ã€‚

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
æ¬¡ã®ä¾‹ã¯ã€[Microsoft 365 Copilot (PWA)](https://apps.microsoft.com/detail/9WZDNCRD29V9?hl=ja&gl=JP&ocid=pdpshare)ã¨ã—ã¦ã€CollectionIDã‚’ä½œæˆã—ã€ãã“ã®ä¸­ã§é€šçŸ¥ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

> [!WARNING]
> IconPath ã§ã™ãŒã€ã‚¢ãƒ—ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã£ã¦ã¯ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ãŒæ©Ÿèƒ½ã—ãªã„ãŸã‚ã€ãã®éš›ã¯é©å®œä¿®æ­£ã—ã¦ä¸‹ã•ã„ã€‚

```bas
Sub ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ãŸãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã®ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ä½œæˆ()
    'CollectionIDã‚’ã‚»ãƒƒãƒˆ
    Const CollectionID As String = "TestGroup"
    
    With New clsAppNotificationBuilder
        'PWA Microsoft 365 ã‚’æŒ‡å®š
        .SetAppUserModelID = "Microsoft.MicrosoftOfficeHub_8wekyb3d8bbwe!Microsoft.MicrosoftOfficeHub"

        'ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã®ä½œæˆ
        Debug.Print .RunDll_ToastCollectionManagerSaveToastCollectionAsync(CollectionID, "Aç¤¾ ãƒ­ã‚°é–¢ä¿‚", "https://www.microsoft365.com/launch/excel", "C:\Program Files\WindowsApps\Microsoft.MicrosoftOfficeHub_19.2506.33061.0_x64__8wekyb3d8bbwe\Images\AppExcel32x32.png")
        Stop

        'é€šçŸ¥å†…å®¹ã‚’ä½œæˆ
        .SetToastGenericTitleText = "Hello World"
        .SetToastGenericContentsText = "CollectionçµŒç”±ã§é€šçŸ¥ã—ã¾ã—ãŸ"
        .SetToastGenericAttributionText = "ToastCollectionTest"

        'ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ã‚¯ãƒªã‚¢
        .SetToastHeader(vbNullString) = ""

        'ä½œã£ãŸCollectionã«ãƒˆãƒ¼ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¦è¡¨ç¤º
        .RunDll_ToastNotifierShow "CollectionTest", CollectionID
    End With
End Sub
```

#### é€šçŸ¥ã®æ¯”è¼ƒ

|       çµŒç”±   | ãƒˆãƒ¼ã‚¹ãƒˆ       | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚»ãƒ³ã‚¿ãƒ¼                                                                                                             | 
| ------------ | ------------ | ---------------------------------------------------------------------------------------------------------------- | 
| Collection   | ![alt text](doc/Ex_Collection1-1.png) | ![alt text](doc/Ex_Collection1-2.png) |
| é€šå¸¸         | ![alt text](doc/æ¯”è¼ƒ1.png) | ![alt text](doc/æ¯”è¼ƒ2.png) |

ã€Œé€šå¸¸ã€ã§ã¯ã€ã‚¢ãƒ—ãƒªåãŒå¿…ãšã‚°ãƒ«ãƒ¼ãƒ—åç§°ã«ãªã‚Šã¾ã™ã€‚<br>
å¯¾ã—ã¦ã€ã€ŒCollectionã€ã¯ä»»æ„ã®ã‚°ãƒ«ãƒ¼ãƒ—åç§°ã§è¨­å®šãŒå¯èƒ½ã§ã™ã€‚<br>
ã‚¢ã‚¤ã‚³ãƒ³ç”»åƒã«ã¤ã„ã¦ã¯ã€Microsoft 365 (PWA)ã‚’[ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«](https://www.microsoft.com/store/productId/9WZDNCRD29V9?ocid=pdpshare)ã™ã‚‹ã“ã¨ã§ã€åŸºæœ¬çš„ãªOfficeã‚¢ã‚¤ã‚³ãƒ³ã®ã‚»ãƒƒãƒˆãŒã¤ã„ã¦ãã¾ã™ã€‚

> [!CAUTION]
> ã“ã®æ©Ÿèƒ½ã¯UWPç‰ˆã‚’å‰æã«è¨­è¨ˆã—ã¦ã„ã‚‹å½±éŸ¿ã§ã€DeskTopç‰ˆã§ã‚‚ä½¿ãˆãªãã¯ãªã„ã§ã™ãŒä¸‹è¨˜ç”»åƒã®ã‚ˆã†ã«æ­£ã—ãè¨­å®šã§ãã¾ã›ã‚“ã€‚
>
> ![alt text](doc/Ex_Collection2.png)<br>
> - DisplayName ,IconUri ãŒç„¡è¦–ã•ã‚Œã¾ã™
> - CollectionId ãŒ DisplayNameæ‰±ã„ã«ãªã‚Šã¾ã™ã€‚

### RunRunDll_ToastCollectionManagerRemoveToastCollectionAsync

ã€ŒRunDll_ToastCollectionManagerSaveToastCollectionAsyncã€ç­‰ã§ä½œæˆã—ãŸCollectionIDã®ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã‚’å‰Šé™¤ã—ã¾ã™ã€‚

#### åˆ©ç”¨å¯èƒ½ãªå¼•æ•°

| å¼•æ•°å       | èª¬æ˜                                                                                                             | 
| ------------ | ---------------------------------------------------------------------------------------------------------------- | 
| CollectionId | å‰Šé™¤ã—ãŸã„ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³é€šçŸ¥ã® ID ã‚’è¨­å®šã—ã¾ã™ã€‚<br><br>ãƒ»æŒ‡å®šæ™‚ã€[ãã®CollectionIDã®ã¿å‰Šé™¤](https://learn.microsoft.com/ja-jp/uwp/api/windows.ui.notifications.toastcollectionmanager.removetoastcollectionasync)<br>ãƒ»çœç•¥æ™‚ã€[å…¨ã¦ã®CollectionIDã‚’å‰Šé™¤](https://learn.microsoft.com/ja-jp/uwp/api/windows.ui.notifications.toastcollectionmanager.removealltoastcollectionsasync)                                                                         | 

#### è¿”ã‚Šå€¤
å‰Šé™¤ã«æˆåŠŸã™ã‚‹ã¨ã€0 ã‚’è¿”ã—ã¾ã™ã€‚

#### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
æ¬¡ã®ä¾‹ã¯ã€Microsoft 365 (PWA)ã¨ã—ã¦ã€å‰è¿°ã®ä¾‹ã§ä½œæˆã—ãŸCollectionIDã‚’æŒ‡å®šã—ã€å‰Šé™¤ã—ã¾ã™

```bas
Sub ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ãŸãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã®ã‚°ãƒ«ãƒ¼ãƒ—åŒ–å‰Šé™¤()
    'CollectionIDã‚’ã‚»ãƒƒãƒˆ
    Const CollectionID As String = "TestGroup"
    
    With New clsAppNotificationBuilder
        'PWA Microsoft 365 ã‚’æŒ‡å®š
        .SetAppUserModelID = "Microsoft.MicrosoftOfficeHub_8wekyb3d8bbwe!Microsoft.MicrosoftOfficeHub"

        'ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‰Šé™¤
        Debug.Print .RunDll_ToastCollectionManagerRemoveToastCollectionAsync(CollectionID)
    End With
End Sub
```

> [!TIP]
> ç„¡é—‡ã«CollectionIDã‚’ä½œæˆã—ã¾ãã‚‹ã¨ã€[é€šçŸ¥è¨­å®š](ms-settings:notifications)ã«ã€èµ¤æ ã®ã‚ˆã†ãªæ¬„ãŒå¢—æ®–ã—ã¦ã—ã¾ã†ã®ã§ã€`RunRunDll_ToastCollectionManagerRemoveToastCollectionAsync` ã§ã€å¿…è¦ã«å¿œã˜ã¦å‰Šé™¤ã‚’è¡Œã£ã¦ä¸‹ã•ã„ã€‚<br>
> ![alt text](doc/Ex_Collection3.png)

# [ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–å‡¦ç†](https://learn.microsoft.com/ja-jp/uwp/api/windows.ui.notifications.toastnotification.activated)
ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¯ãƒªãƒƒã‚¯ã¾ãŸã¯ã‚¿ãƒƒãƒã§ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ã—ãŸã¨ãã€æŒ‡å®šãƒã‚¯ãƒ­ã‚’å®Ÿè¡Œã™ã‚‹äº‹ãŒã§ãã¾ã™ã€‚<br>
actionè¦ç´ ã®argumentså±æ€§ã«ãƒã‚¯ãƒ­åã€activationTypeå±æ€§ã«`taForeground`ã‚’è¨­å®šã—ã¦ã€`RunDll_ToastNotifierShow`é–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹äº‹ã§ã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–å‡¦ç†ãŒå¯èƒ½ã§ã™ã€‚<br>

> [!CAUTION]
> ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–å‡¦ç†ã¯ã€DLLçµŒç”±ã«ã‚ˆã‚‹`RunDll_ToastNotifierShow`ã§ã®å®Ÿè¡ŒãŒå¿…è¦ã§ã™ã€‚  
> ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«é€šçŸ¥ã§ç™ºè¡Œã—ãŸã‚¢ãƒ—ãƒªé€šçŸ¥ã®å ´åˆã¯ã€ä¸Šè¨˜ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–å‡¦ç†ã¯ã§ãã¾ã›ã‚“ã€‚

## ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–æº–å‚™

### ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ã§ãã‚‹ç®‡æ‰€

ä¸‹è¨˜ã®è¦ç´ ã¨å±æ€§ã«ã€å®Ÿè¡Œã—ãŸã„ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£åã‚’è¨˜è¿°ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
- toastè¦ç´  ï¼ [launchå±æ€§](https://learn.microsoft.com/ja-jp/uwp/schemas/tiles/toastschema/element-toast#:~:text=%E3%81%AA%E3%81%97-,launch,-%E3%83%88%E3%83%BC%E3%82%B9%E3%83%88%E9%80%9A%E7%9F%A5%E3%81%AB%E3%82%88%E3%81%A3%E3%81%A6)
```bas
    With New clsAppNotificationBuilder
        .SetToastContent_Launch(taForeground) = "[ã“ã“ã«å®Ÿè¡Œã—ãŸã„ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£å]"
        ~
    End With
```

- actionè¦ç´  ï¼ [argumentså±æ€§](https://learn.microsoft.com/ja-jp/uwp/schemas/tiles/toastschema/element-action#:~:text=%E3%81%AA%E3%81%97-,arguments,-%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%8C%E3%81%93%E3%81%AE)
```bas
    With New clsAppNotificationBuilder
        .SetIToastActions("TestRun", "[ã“ã“ã«å®Ÿè¡Œã—ãŸã„ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£å]", taForeground) = 1
        ~
    End With
```
> [!CAUTION]
> ã§ãã‚‹ã ã‘ã€ãƒ–ãƒƒã‚¯å†…ã«ã¦ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£åã¯ã€ãƒ¦ãƒ‹ãƒ¼ã‚¯ã«ã—ã¦ãã ã•ã„ã€‚  
> ã©ãƒ¼ãƒ¼ã—ã¦ã‚‚ãªã‚‰ã€`Module1.Run01FromToast` ã¨ã„ã†æ›¸ãæ–¹ã§ã‚‚å‹•ä½œã—ã¾ã™ã€‚

> [!IMPORTANT]
> headerè¦ç´ ã‚‚åŒã˜ã‚ˆã†ãªæ„å‘³ã®å±æ€§ãŒã‚ã‚Šã¾ã™ãŒã€Microsoftã®è¨­è¨ˆæ€æƒ³ã®éƒ½åˆä¸Šã€`protocol`ã§æ‰±ã†ã®ãŒç„¡é›£ã§ã™ã€‚


### ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–æ™‚ã®ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£è¨˜è¿°
ä¸‹è¨˜ã®è¦ä»¶ã«åˆã†ã‚ˆã†ã«è¨˜è¿°ã™ã‚‹ã“ã¨

#### å¼•æ•°
| é †ç•ª | å‹      | èª¬æ˜                                                                            | 
| ---- | ------- | ------------------------------------------------------------------------------- | 
| 1    | Variant | 2æ¬¡å…ƒé…åˆ—<br>ãƒ»è¡Œæ•°ï¼šå…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰(Inputè¦ç´ )ã®æ•°ã€‚æœ€å¤§5ã¤<br>ãƒ»åˆ—æ•°ï¼š2ï¼ˆã‚­ãƒ¼ã¨å€¤ã®ãƒšã‚¢ï¼‰ | 

#### é…åˆ—ã®æ§‹é€ ã«ã¤ã„ã¦
![alt text](doc/ToastActived1.png)
| åˆ—ä½ç½®  | èª¬æ˜                                                                            | 
| ----  | ------------------------------------------------------------------------------- | 
| 0     | Inputè¦ç´ ã®IDå±æ€§ã®åç§° |
| 1     | Inputè¦ç´ ã®IDå±æ€§ã«ç´ã¥ãå…¥åŠ›å€¤ã€‚<br> selectionè¦ç´ ã§ã®å…¥åŠ›å€¤ã®å ´åˆã€ãã®IDå±æ€§ã®åç§°ã¨ãªã‚Šã¾ã™ã€‚|

- æœ€å°è¦ç´ æ•°ï¼š0
- å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒãªã„å ´åˆã¯è¡Œæ•°ãŒã€-1
- åˆ©ç”¨æ™‚ã«ã¯ã€CreateObject("Scripting.Dictionary") ã§æ•´ç†ã™ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚
- å¼•æ•°ã‚’æ‰±ã‚ãªã„ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã§ã‚‚ã€ç”¨æ„ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

#### ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã®ç¨®é¡
Sub,Function å•ã„ã¾ã›ã‚“ãŒã€publicã¨ã—ã¦è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
ã„ãã¤ã‹ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½“é¨“ã§ãã‚‹ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’æç¤ºã—ã¾ã™ã€‚<br>
ã“ã®ä¾‹ã§ã¯ã€ã‚¢ãƒ—ãƒªé€šçŸ¥ä¸Šã§ç°¡æ˜“çš„ãªã‚¯ã‚¤ã‚ºã‚’ä½œã£ã¦ã¿ã¾ã™ã€‚
```bas
Option Explicit

'ãƒˆãƒ¼ã‚¹ãƒˆã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ãƒ†ã‚¹ãƒˆ
Sub ToastWithActiveShow()
    With New clsAppNotificationBuilder
        'ã‚¿ã‚¤ãƒˆãƒ«è¨­å®š
        .SetToastGenericTitleText = "ã‚¯ã‚¤ã‚ºï¼"
        'å†…å®¹è¨­å®š
        .SetToastGenericContentsText = "æ­£ã—ã„å›ç­”ã‚’é¸æŠã€å…¥åŠ›ã—ã‚ˆã†"
        'ã‚½ãƒ¼ã‚¹
        .SetToastGenericAttributionText = "ãƒˆãƒ¼ã‚¹ãƒˆã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ãƒ†ã‚¹ãƒˆ"
        'synalioã‚’ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã«ã™ã‚‹
        .SetToastContent_Scenario = tsReminder
        'ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ã‚¯ãƒªã‚¢
        .SetToastHeader = ""
        
        
        'ãƒˆãƒ¼ã‚¹ãƒˆã‚¯ãƒªãƒƒã‚¯æ™‚ã®ã€ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£åã‚’è¨˜è¼‰
        .SetToastContent_Launch(taForeground) = "ToastTrigger_Click"
        
        
        'é¸æŠè‚¢ã‚’ç”¨æ„ã™ã‚‹
        .SetToastSelectionBox("é¸æŠè‚¢A", "1 m") = 1
        .SetToastSelectionBox("é¸æŠè‚¢B", "1 km") = 2
        .SetToastSelectionBox("é¸æŠè‚¢C", "1 å¤©æ–‡å˜ä½") = 3
        .SetToastSelectionBox("é¸æŠè‚¢D", "1 å…‰å¹´") = 4
        'ä¸Šè¨˜ã®é¸æŠè‚¢ã‚’ã€ä¸‹è¨˜ã®Inputè¦ç´ ã¨ã—ã¦ã€ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
        .SetIToastInput("åœ°å­¦å•é¡Œ", True, , "Q1ï¼šå¤ªé™½ã‹ã‚‰åœ°çƒã®è·é›¢ã¯ï¼Ÿ") = 1
        
        'ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ã‚’ç”¨æ„
        .SetIToastInput("å†¥ç‹æ˜Ÿã¨ã¯", , , "Q2ï¼šå†¥ç‹æ˜Ÿã¯ä½•æƒ‘æ˜Ÿï¼Ÿ", "ã€‡æƒ‘æ˜Ÿ") = 2
        
        'å„ãƒœã‚¿ãƒ³ã«å¯¾å¿œã™ã‚‹ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£åã‚’è¨˜è¼‰(æ¥é ­èªç­‰ã‚’ä»˜ã‘ã¦åŒºåˆ¥ã‚’ã¤ã‘ã‚ˆã†)
        .SetIToastActions("å›ç­”ã™ã‚‹", "ToastTrigger_Answer", taForeground) = 1
        .SetIToastActions("é–‰ã˜ã‚‹", "ToastTrigger_Close", taForeground) = 2
        
        'é€šçŸ¥å®Ÿè¡Œ
        .RunDll_ToastNotifierShow "RunMacto"
    End With
End Sub



'-----------------------C++(ToastActive)ã‹ã‚‰å‘¼ã°ã‚Œã‚‹ãƒã‚¯ãƒ­ã‚’è¨˜è¿°-----------------------
'ã‚¯ãƒªãƒƒã‚¯æ™‚
Sub ToastTrigger_Click(UserInputs As Variant)
    'ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹ã ã‘
    MsgBox "ã‚¢ãƒ—ãƒªé€šçŸ¥ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€ãƒã‚¯ãƒ­èµ·å‹•ã—ã¾ã—ãŸ", vbInformation, "ã‚¯ãƒªãƒƒã‚¯ã§ã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ãƒ†ã‚¹ãƒˆ"
End Sub

'1ã¤ç›®ã®ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚
Sub ToastTrigger_Answer(UserInputs As Variant)
    Dim Dict_UserInputs As Object
    Dim keyToFind As String
    Dim foundValue As Variant
    
    ' Scripting.Dictionaryã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
    Set Dict_UserInputs = CreateObject("Scripting.Dictionary")
    Dim i As Long
    For i = 0 To UBound(UserInputs)
        'ã‚­ãƒ¼ã¨å€¤ã‚’è¨­å®š
        Dict_UserInputs.Add UserInputs(i, 0), UserInputs(i, 1)
    Next

    'AnswerCheck1
    If Dict_UserInputs("åœ°å­¦å•é¡Œ") = "é¸æŠè‚¢C" Then
        MsgBox "æ­£è§£ï¼", vbInformation, "å•é¡Œ1ã®çµæœ"
    Else
        MsgBox "ä¸æ­£è§£", vbCritical, "å•é¡Œ1ã®çµæœ"
        Exit Sub
    End If
    
    'AnswerCheck2
    If Dict_UserInputs("å†¥ç‹æ˜Ÿã¨ã¯") = "æº–æƒ‘æ˜Ÿ" Then
        MsgBox "æ­£è§£ï¼", vbInformation, "å•é¡Œ2ã®çµæœ"
    Else
        MsgBox "ä¸æ­£è§£", vbCritical, "å•é¡Œ2ã®çµæœ"
        Exit Sub
    End If
    
    MsgBox "å…¨å•æ­£è§£ï¼", vbInformation, "All Clear!"
    
End Sub

'2ã¤ç›®ã®ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚
Sub ToastTrigger_Close(UserInputs As Variant)
    'ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹ã ã‘
    MsgBox "å›ç­”ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã—ãŸ", vbExclamation, "å›ç­”è¾é€€"
End Sub
```
![alt text](doc/ToastActived2.png)<br>
ã‚¢ãƒ—ãƒªé€šçŸ¥ã§é¸æŠã—ãŸé¸æŠè‚¢ã‚„ã€å…¥åŠ›ãƒ†ã‚­ã‚¹ãƒˆã‚’æ‰±ã†å ´åˆã¯ã€äºˆã‚è¾æ›¸å‹ï¼ˆScripting.Dictionaryï¼‰ã§å†…å®¹ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦å‡¦ç†ã™ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚

# ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§æ©Ÿèƒ½
ã²ã‚‰ã‚ãæ¬¡ç¬¬ã§ã¯ä½¿ãˆã‚‹ã‹ã‚‚â€¦? ãªã€ç¾æ™‚ç‚¹ã§æ‰±ãˆã‚‹ã‚¤ãƒ™ãƒ³ãƒˆæ©Ÿèƒ½ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚
> [!CAUTION]
> DLLçµŒç”±ã§è¡¨ç¤ºã—ãŸãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã®ã¿å‹•ä½œã—ã¾ã™ã€‚

## [Dismissed ã‚¤ãƒ™ãƒ³ãƒˆ](https://learn.microsoft.com/ja-jp/uwp/api/windows.ui.notifications.toastnotification.dismissed)
ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ãŒã€æœ‰åŠ¹æœŸé™ãŒåˆ‡ã‚Œã¦ã„ã‚‹ã‹ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã£ã¦æ˜ç¤ºçš„ã«ç„¡è¦–ã•ã‚ŒãŸçŠ¶æ…‹ã«ãªã‚‹ã¨ã€ç™ºç”Ÿã—ã¾ã™ã€‚
### å‹•ä½œç¢ºèªæ–¹æ³•
1. ä¸‹è¨˜ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ä»»æ„ã®æ¨™æº–Moduleã¸è²¼ã‚Šä»˜ã‘ã§ä¸‹ã•ã„ã€‚

```bas
Sub DismissedTest()
    With New clsAppNotificationBuilder
        '1. ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£è¨­å®š
       .SetToastGenericTitleText = "Hello World"
       .SetToastGenericContentsText = "Test message"

        '2. ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè¡Œ
       .RunDll_ToastNotifierShow "Hello World"
    End With
End Sub

Sub ExcelToast_Dismissed(ç†ç”±)
    Debug.Print "Toast.Tagï¼š" & ç†ç”±(0, 0) & "ã€€ã«ã¦ã€Dismissed ç™ºç”Ÿ"

    Select Case ç†ç”±(0, 1)
        Case 0: Debug.Print "ç†ç”±ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’ç„¡è¦–ã—ã¾ã—ãŸã€‚"
        Case 1: Debug.Print "ç†ç”±ï¼šã‚¢ãƒ—ãƒªã¯ã€ ToastNotifier.hide ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã—ã¦ã€ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’æ˜ç¤ºçš„ã«éš ã—ã¾ã—ãŸã€‚"
        Case 2: Debug.Print "ç†ç”±ï¼šãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã¯æœ€å¤§è¨±å®¹æ™‚é–“ã§è¡¨ç¤ºã•ã‚Œã€ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆã•ã‚Œã¾ã—ãŸã€‚ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’è¡¨ç¤ºã™ã‚‹æœ€å¤§æ™‚é–“ã¯ 7 ç§’ã§ã™ãŒã€é•·æ™‚é–“ã®ãƒˆãƒ¼ã‚¹ãƒˆã®å ´åˆã¯ 25 ç§’ã§ã™ã€‚"
        Case Else: Debug.Print "ç†ç”±ï¼šäºˆæœŸã›ã¬ã‚¨ãƒ©ãƒ¼ã€€Codeï¼š" & ç†ç”±(0, 0)
    End Select
    
    Debug.Print ""
End Sub
```

2. DismissedTest ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã“ã®çŠ¶æ…‹ã§ã—ã°ã‚‰ãå¾…ã£ã¦ã€é€šçŸ¥ãŒã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚»ãƒ³ã‚¿ãƒ¼ã«æ ¼ç´ã•ã‚Œã‚‹ã¨â€¦
```
Toast.Tagï¼šHello Worldã€€ã«ã¦ã€Dismissed ç™ºç”Ÿ
ç†ç”±ï¼šãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã¯æœ€å¤§è¨±å®¹æ™‚é–“ã§è¡¨ç¤ºã•ã‚Œã€ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆã•ã‚Œã¾ã—ãŸã€‚ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’è¡¨ç¤ºã™ã‚‹æœ€å¤§æ™‚é–“ã¯ 7 ç§’ã§ã™ãŒã€é•·æ™‚é–“ã®ãƒˆãƒ¼ã‚¹ãƒˆã®å ´åˆã¯ 25 ç§’ã§ã™ã€‚
```
ã¨ã‚¤ãƒŸãƒ‡ã‚£ã‚¨ã‚¤ãƒˆã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

#### å¼•æ•°ã«ã¤ã„ã¦
2æ¬¡å…ƒé…åˆ—ã§ã™ãŒã€1è¡Œåˆ†ã®ã¿ã§ã™ã€‚
- 1åˆ—ç›®ï¼šDismissed ã«ãªã£ãŸ Tagå
- 2åˆ—ç›®ï¼š[ToastDismissalReason åˆ—æŒ™å‹](https://learn.microsoft.com/ja-jp/uwp/api/windows.ui.notifications.toastdismissalreason)

## [Failed ã‚¤ãƒ™ãƒ³ãƒˆ](https://learn.microsoft.com/ja-jp/uwp/api/windows.ui.notifications.toastnotification.failed)
Windows ãŒãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’ç”Ÿæˆã—ã‚ˆã†ã¨ã—ãŸã¨ãã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸã¨ãã«ç™ºç”Ÿã—ã¾ã™ã€‚
### å‹•ä½œç¢ºèªæ–¹æ³•
1. ä¸‹è¨˜ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ä»»æ„ã®æ¨™æº–Moduleã¸è²¼ã‚Šä»˜ã‘ã§ä¸‹ã•ã„ã€‚

```bas
Sub FailedTest()
    With New clsAppNotificationBuilder
        '1. ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£è¨­å®š
       .SetToastGenericTitleText = "Hello World"
       .SetToastGenericContentsText = "Test message"

        '2. ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè¡Œ
       .RunDll_ToastNotifierShow "Hello World"
    End With
End Sub

Sub ExcelToast_Failed(ã‚¨ãƒ©ãƒ¼ç†ç”±)
    Debug.Print "Toast.Tagï¼š" & ã‚¨ãƒ©ãƒ¼ç†ç”±(0, 0) & "ã€€ã«ã¦ã€Failed ç™ºç”Ÿ"

    Debug.Print "åŸå› ï¼š" & ã‚¨ãƒ©ãƒ¼ç†ç”±(0, 1) & vbcrlf
End Sub
```

2. Excel ã®é€šçŸ¥ã€ã‚ã‚‹ã„ã¯é€šçŸ¥æ©Ÿèƒ½å…¨èˆ¬ã‚’OFFã«ã—ã¾ã™ã€‚  
![alt text](doc/Failed1.png)

3. FailedTest ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã™ã‚‹ã¨ã€
```
Toast.Tagï¼šHello Worldã€€ã«ã¦ã€Failed ç™ºç”Ÿ
åŸå› ï¼š0x803E0111
ç¾åœ¨ã®è¨­å®šã§ã¯ã€é€šçŸ¥ã‚’é…ä¿¡ã§ãã¾ã›ã‚“ã€‚
```
ã¨ã‚¤ãƒŸãƒ‡ã‚£ã‚¨ã‚¤ãƒˆã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

#### å¼•æ•°ã«ã¤ã„ã¦
2æ¬¡å…ƒé…åˆ—ã§ã™ãŒã€1è¡Œåˆ†ã®ã¿ã§ã™ã€‚
- 1åˆ—ç›®ï¼šFailed ã«ãªã£ãŸ Tagå
- 2åˆ—ç›®ï¼šã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã¨ã‚¨ãƒ©ãƒ¼å†…å®¹

# httpã‚½ãƒ¼ã‚¹ç”»åƒã®å–ã‚Šæ‰±ã„ã«ã¤ã„ã¦
## AllowUse_InternetImage ã®æŒ™å‹•
Trueã«ã™ã‚‹ã¨ã€ç”»åƒè¨­å®šé–¢é€£(SetToastGenericAppLogoç­‰)ã«ã¦ã€Œhttpã€å§‹ã¾ã‚Šã®ã‚½ãƒ¼ã‚¹ã‚’ã€[WindowsAPI:URLDownloadToFile](http://officetanaka.net/other/extra/tips01.htm) ã‚’ä»‹ã—ã¦ã€ç’°å¢ƒå¤‰æ•°tmp(C:\Users\XXX\AppData\Local\Temp)ã«ä¿å­˜ã—ã¾ã™ã€‚ãã—ã¦ã€ä¿å­˜ã—ãŸãƒ‘ã‚¹ã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ã‚¹ã‚’è¿”ã—ã¦ã€ç”»åƒä»˜ãé€šçŸ¥ã‚’è¡¨ç¤ºã•ã›ã¦ã„ã¾ã™ã€‚DLãŒçµ‚ã‚ã‚‹ã¾ã§ã¯é€šçŸ¥ãŒã§ãªã„ã®ã§ã”æ³¨æ„ä¸‹ã•ã„ã€‚<br>
Tempãƒ•ã‚©ãƒ«ãƒ€å†…ã¯ä¸€å®šæœŸé–“éãã‚‹ã¨è‡ªå‹•ã§å‰Šé™¤ã•ã‚Œã¾ã™ãŒã€ã¾ã æ®‹ã£ã¦ã„ã‚‹å ´åˆã¯DLã¯ã›ãšã€ç›´ãã«é€šçŸ¥ã‚’è¡¨ç¤ºã•ã›ã¦ã„ã¾ã™ã€‚

## AppUserModelID ã®ä»•æ§˜
Excelç­‰ã®ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€ã€Œéãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åŒ–ã‚¢ãƒ—ãƒªã€æ‰±ã„ã¨ãªã‚ŠToastã®ä»•æ§˜ä¸Šã€[HTTP ã‚¤ãƒ¡ãƒ¼ã‚¸ã¯ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚](https://learn.microsoft.com/ja-jp/windows/apps/design/shell/tiles-and-notifications/send-local-toast-desktop-cpp-wrl#step-7-send-a-notification)ã“ã‚Œã‚’è§£æ±ºã™ã‚‹ã¹ãã€å‰è¿°ã®AllowUse_InternetImage ã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚<br>
ãŸã ã—ã€ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ©Ÿèƒ½ãŒã‚ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¢ãƒ—ãƒªã®AppUserModelIDã‚’æŒ‡å®šã™ã‚‹å ´åˆã€ã€ŒAllowUse_InternetImage = trueã€ã‚’ã™ã‚‹å¿…è¦ãªãã€httpã‚½ãƒ¼ã‚¹ç”»åƒä»˜ãé€šçŸ¥ãŒä½¿ãˆã¾ã™ã€‚<br>
batå‡¦ç†ç­‰ã§httpã‚½ãƒ¼ã‚¹ç”»åƒä»˜ãé€šçŸ¥ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€å¯¾å¿œã™ã‚‹AppUserModelIDã‚’æŒ‡å®šã—ã¦ã€ã€ŒGenerateCmd_ToastNotifierShowã€ã§è¿”ã‚‹æ–‡å­—åˆ—ã‚’åŸ‹ã‚è¾¼ã¿ã¾ã—ã‚‡ã†ã€‚
```bas
Sub httpã‚½ãƒ¼ã‚¹ã®ç”»åƒä»˜ãé€šçŸ¥()
    With New clsAppNotificationBuilder
        'ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ©Ÿèƒ½ãŒã‚ã‚‹AppUserModelID
        .SetAppUserModelID = "Microsoft.WindowsTerminal_8wekyb3d8bbwe!App"

        .SetToastGenericTitleText = "ä¸Šéƒ¨ã«ç”»åƒã‚’è¡¨ç¤º"
        .SetToastGenericHeroImage = "https://pad.gungho.jp/member/img/graphic/illust/6828.png"


        Shell .GenerateCmd_ToastNotifierShow("withImageToast"), vbHide
    End With
End Sub
```
![alt text](doc/ExampleAppUserModelID.png)

# Attention
DLLå´ã®å‡¦ç†ã¯ã€ã‚ã‚‹ç¨‹åº¦ã®ã‚¨ãƒ©ãƒ¼å‡¦ç†ã‚’æ–½ã—ã¦ã„ã¾ã™ãŒã€ç¾æ™‚ç‚¹ã§ã¯ã‚ã¾ã‚Šå®Œç’§ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<br>
ä¸€å¿œã€ã‚¯ãƒ©ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«å´ã§ã‚‚ã‚¨ãƒ©ãƒ¼å‡¦ç†ã‚’æ–½ã—ã¦ã„ã¾ã™ãŒã€çªç„¶ExcelãŒè½ã¡ã‚‹ã“ã¨ãŒã‚ã‚‹ã®ã§åˆ©ç”¨å‰ã«ã¯ä¿å­˜ã‚’æ¨å¥¨ã—ã¾ã™ã€‚
